!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).BoardgameIO={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f(this,n)}}function p(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=v(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}var g=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),y=function(){return Math.random().toString(36).substring(7).split("").join(".")},b={INIT:"@@redux/INIT"+y(),REPLACE:"@@redux/REPLACE"+y(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+y()}};function x(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function w(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(w)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,i=t,a=[],l=a,s=!1;function c(){l===a&&(l=a.slice())}function u(){if(s)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function f(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(s)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return c(),l.push(e),function(){if(t){if(s)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,c();var n=l.indexOf(e);l.splice(n,1),a=null}}}function d(e){if(!x(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(s)throw new Error("Reducers may not dispatch actions.");try{s=!0,i=o(i,e)}finally{s=!1}for(var t=a=l,n=0;n<t.length;n++){(0,t[n])()}return e}function p(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,d({type:b.REPLACE})}function v(){var e,t=f;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[g]=function(){return this},e}return d({type:b.INIT}),(r={dispatch:d,subscribe:f,getState:u,replaceReducer:p})[g]=v,r}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function I(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return O({},n,{dispatch:r=k.apply(void 0,i)(n.dispatch)})}}}const E=(e,t,n,r)=>({type:"MAKE_MOVE",payload:{type:e,args:t,playerID:n,credentials:r}}),_=(e,t,n,r)=>({type:"GAME_EVENT",payload:{type:e,args:t,playerID:n,credentials:r}}),D=(e,t,n,r)=>({type:"GAME_EVENT",payload:{type:e,args:t,playerID:n,credentials:r},automatic:!0}),j=e=>({type:"SYNC",state:e.state,log:e.log,initialState:e.initialState,clientOnly:!0}),S=e=>({type:"RESET",state:e,clientOnly:!0}),A=(e,t)=>({type:"UNDO",payload:{type:null,args:null,playerID:e,credentials:t}}),C=(e,t)=>({type:"REDO",payload:{type:null,args:null,playerID:e,credentials:t}});var z,M,N,q=Object.freeze({__proto__:null,makeMove:E,gameEvent:_,automaticGameEvent:D,sync:j,update:(e,t)=>({type:"UPDATE",state:e,deltalog:t,clientOnly:!0}),reset:S,undo:A,redo:C,plugin:(e,t,n,r)=>({type:"PLUGIN",payload:{type:e,args:t,playerID:n,credentials:r}})}),G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),B="undefined"!=typeof Symbol?Symbol("immer-nothing"):(N=!0,(M="immer-nothing")in(z={})?Object.defineProperty(z,M,{value:N,enumerable:!0,configurable:!0,writable:!0}):z[M]=N,z),L="undefined"!=typeof Symbol?Symbol("immer-draftable"):"__$immer_draftable",R="undefined"!=typeof Symbol?Symbol("immer-state"):"__$immer_state";function F(e){return!!e&&!!e[R]}function U(e){if(!e||"object"!==(void 0===e?"undefined":G(e)))return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype||(!!e[L]||!!e.constructor[L])}var V=Object.assign||function(e,t){for(var n in t)Y(t,n)&&(e[n]=t[n]);return e},K="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function J(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e))return e.slice();var n=Object.create(Object.getPrototypeOf(e));return K(e).forEach((function(r){if(r!==R){var o=Object.getOwnPropertyDescriptor(e,r);if(o.get){if(!t)throw new Error("Immer drafts cannot have computed properties");o.value=o.get.call(e)}o.enumerable?n[r]=o.value:Object.defineProperty(n,r,{value:o.value,writable:!0,configurable:!0})}})),n}function H(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(n,e[n],e);else K(e).forEach((function(n){return t(n,e[n],e)}))}function W(e,t){return Object.getOwnPropertyDescriptor(e,t).enumerable}function Y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Q(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var X={},Z=[],ee=function(){return Z[Z.length-1]};function te(e,t){var n=Array.isArray(e),r=ae(e);H(r,(function(t){!function(e,t,n){var r=X[t];r?r.enumerable=n:X[t]=r={configurable:!0,enumerable:n,get:function(){return function(e,t){le(e);var n=re(e)[t];if(!e.finalizing&&n===e.base[t]&&U(n))return ie(e),e.copy[t]=te(n,e);return n}(this[R],t)},set:function(e){!function(e,t,n){if(le(e),e.assigned[t]=!0,!e.modified){if(Q(re(e)[t],n))return;oe(e),ie(e)}e.copy[t]=n}(this[R],t,e)}};Object.defineProperty(e,t,r)}(r,t,n||W(e,t))}));var o={scope:t?t.scope:ee(),modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:r,copy:null,revoke:ne,revoked:!1};return function(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!0})}(r,R,o),o.scope.push(o),r}function ne(){this.revoked=!0}function re(e){return e.copy||e.base}function oe(e){e.modified||(e.modified=!0,e.parent&&oe(e.parent))}function ie(e){e.copy||(e.copy=ae(e.base))}function ae(e){var t=e&&e[R];if(t){t.finalizing=!0;var n=J(t.draft,!0);return t.finalizing=!1,n}return J(e)}function le(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(re(e)))}function se(e){for(var t=e.base,n=e.draft,r=Object.keys(n),o=r.length-1;o>=0;o--)if(void 0===t[r[o]]&&!Y(t,r[o]))return!0;return r.length!==Object.keys(t).length}function ce(e){var t=e.draft;if(t.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var ue=Object.freeze({scopes:Z,currentScope:ee,willFinalize:function(e,t,n){var r=ee();r.forEach((function(e){return e.finalizing=!0})),void 0!==e&&e!==t||(n&&function e(t){if(!t||"object"!==(void 0===t?"undefined":G(t)))return;var n=t[R];if(!n)return;var r=n.base,o=n.draft,i=n.assigned;if(Array.isArray(t)){if(ce(n)){if(oe(n),i.length=!0,o.length<r.length)for(var a=o.length;a<r.length;a++)i[a]=!1;else for(var l=r.length;l<o.length;l++)i[l]=!0;for(var s=0;s<o.length;s++)void 0===i[s]&&e(o[s])}}else Object.keys(o).forEach((function(t){void 0!==r[t]||Y(r,t)?i[t]||e(o[t]):(i[t]=!0,oe(n))})),Object.keys(r).forEach((function(e){void 0!==o[e]||Y(o,e)||(i[e]=!1,oe(n))}))}(t),function(e){for(var t=e.length-1;t>=0;t--){var n=e[t];!1===n.modified&&(Array.isArray(n.base)?ce(n)&&oe(n):se(n)&&oe(n))}}(r))},createDraft:te}),fe=[],de=function(){return fe[fe.length-1]};function pe(e,t){var n={scope:t?t.scope:de(),modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null},r=Array.isArray(e)?Proxy.revocable([n],he):Proxy.revocable(n,ve),o=r.revoke,i=r.proxy;return n.draft=i,n.revoke=o,n.scope.push(n),i}var ve={get:function(e,t){if(t===R)return e;var n=e.drafts;if(!e.modified&&Y(n,t))return n[t];var r=me(e)[t];if(e.finalized||!U(r))return r;if(e.modified){if(r!==e.base[t])return r;n=e.copy}return n[t]=pe(r,e)},has:function(e,t){return t in me(e)},ownKeys:function(e){return Reflect.ownKeys(me(e))},set:function(e,t,n){if(!e.modified){if(n?Q(e.base[t],n)||n===e.drafts[t]:Q(e.base[t],n)&&t in e.base)return!0;ge(e)}return e.assigned[t]=!0,e.copy[t]=n,!0},deleteProperty:function(e,t){(void 0!==e.base[t]||t in e.base)&&(e.assigned[t]=!1,ge(e));e.copy&&delete e.copy[t];return!0},getOwnPropertyDescriptor:function(e,t){var n=me(e),r=Reflect.getOwnPropertyDescriptor(n,t);r&&(r.writable=!0,r.configurable=!Array.isArray(n)||"length"!==t);return r},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},he={};function me(e){return e.copy||e.base}function ge(e){e.modified||(e.modified=!0,e.copy=V(J(e.base),e.drafts),e.drafts=null,e.parent&&ge(e.parent))}H(ve,(function(e,t){he[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),he.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer only supports deleting array indices");return ve.deleteProperty.call(this,e[0],t)},he.set=function(e,t,n){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer only supports setting array indices and the 'length' property");return ve.set.call(this,e[0],t,n)};var ye=Object.freeze({scopes:fe,currentScope:de,willFinalize:function(){},createDraft:pe});function be(e,t,n,r){Array.isArray(e.base)?function(e,t,n,r){for(var o=e.base,i=e.copy,a=e.assigned,l=Math.min(o.length,i.length),s=0;s<l;s++)if(a[s]&&o[s]!==i[s]){var c=t.concat(s);n.push({op:"replace",path:c,value:i[s]}),r.push({op:"replace",path:c,value:o[s]})}if(l<i.length){for(var u=l;u<i.length;u++)n.push({op:"add",path:t.concat(u),value:i[u]});r.push({op:"replace",path:t.concat("length"),value:o.length})}else if(l<o.length){n.push({op:"replace",path:t.concat("length"),value:i.length});for(var f=l;f<o.length;f++)r.push({op:"add",path:t.concat(f),value:o[f]})}}(e,t,n,r):function(e,t,n,r){var o=e.base,i=e.copy;H(e.assigned,(function(e,a){var l=o[e],s=i[e],c=a?e in o?"replace":"add":"remove";if(l!==s||"replace"!==c){var u=t.concat(e);n.push("remove"===c?{op:c,path:u}:{op:c,path:u,value:s}),r.push("add"===c?{op:"remove",path:u}:"remove"===c?{op:"add",path:u,value:l}:{op:"replace",path:u,value:l})}}))}(e,t,n,r)}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n],o=r.path;if(0===o.length&&"replace"===r.op)e=r.value;else{for(var i=e,a=0;a<o.length-1;a++)if(!(i=i[o[a]])||"object"!==(void 0===i?"undefined":G(i)))throw new Error("Cannot apply patch, path doesn't resolve: "+o.join("/"));var l=o[o.length-1];switch(r.op){case"replace":case"add":i[l]=r.value;break;case"remove":if(Array.isArray(i)){if(l!==i.length-1)throw new Error("Only the last index of an array can be removed, index: "+l+", length: "+i.length);i.length-=1}else delete i[l];break;default:throw new Error("Unsupported patch operation: "+r.op)}}}return e}var we={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:"undefined"==typeof process&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},$e=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,we,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)}return T(e,[{key:"produce",value:function(e,t,n){var r=this;if("function"==typeof e&&"function"!=typeof t){var o=t;return t=e,function(){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return r.produce(a,(function(e){var r;return(r=t).call.apply(r,[e,e].concat(n))}))}}if("function"!=typeof t)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("the third argument of a producer should not be set or a function");var i=void 0;if(U(e)){this.scopes.push([]);var a=this.createDraft(e);try{i=t.call(a,a),this.willFinalize(i,a,!!n);var l=n&&[],s=n&&[];if(void 0===i||i===a)i=this.finalize(a,[],l,s);else{if(a[R].modified)throw new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");U(i)&&(i=this.finalize(i)),n&&(l.push({op:"replace",path:[],value:i}),s.push({op:"replace",path:[],value:e}))}}finally{this.currentScope().forEach((function(e){return e.revoke()})),this.scopes.pop()}n&&n(l,s)}else if(void 0===(i=t(e)))return e;return i===B?void 0:i}},{key:"setAutoFreeze",value:function(e){this.autoFreeze=e}},{key:"setUseProxies",value:function(e){this.useProxies=e,V(this,e?ye:ue)}},{key:"applyPatches",value:function(e,t){return F(e)?xe(e,t):this.produce(e,(function(e){return xe(e,t)}))}},{key:"finalize",value:function(e,t,n,r){var o=this,i=e[R];if(!i)return Object.isFrozen(e)?e:this.finalizeTree(e);if(i.scope!==this.currentScope())return e;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,t,n,r),this.onDelete)if(this.useProxies){var a=i.assigned;for(var l in a)a[l]||this.onDelete(i,l)}else{var s=i.base,c=i.copy;H(s,(function(e){Y(c,e)||o.onDelete(i,e)}))}this.onCopy&&this.onCopy(i),this.autoFreeze&&1===this.scopes.length&&Object.freeze(i.copy),n&&be(i,t,n,r)}return i.copy}},{key:"finalizeTree",value:function(e,t,n,r){var o=this,i=e[R];i&&(this.useProxies||(i.finalizing=!0,i.copy=J(i.draft,!0),i.finalizing=!1),e=i.copy);var a=this.onAssign;return H(e,(function l(s,c,u){if(c===u)throw Error("Immer forbids circular references");var f=!!i&&u===e;if(F(c)){if(c=n&&f&&!i.assigned[s]?o.finalize(c,t.concat(s),n,r):o.finalize(c),Array.isArray(u)||W(u,s)?u[s]=c:Object.defineProperty(u,s,{value:c}),f&&c===i.base[s])return}else{if(f&&Q(c,i.base[s]))return;U(c)&&!Object.isFrozen(c)&&H(c,l)}f&&a&&a(i,s,c)})),e}}]),e}()),Pe=$e.produce;$e.setAutoFreeze.bind($e),$e.setUseProxies.bind($e),$e.applyPatches.bind($e);const Oe={name:"plugin-immer",fnWrap:e=>Pe(e)};function ke(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function Ie(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function Ee(e,n){var r=new ke(e),o=n&&n.state,i=r.next;return i.quick=i,o&&("object"==t(o)&&Ie(o,r),i.state=function(){return Ie(r,{})}),i}var _e=function(){function e(t){n(this,e),this.state=t,this.used=!1}return o(e,[{key:"isUsed",value:function(){return this.used}},{key:"getState",value:function(){return this.state}},{key:"_random",value:function(){this.used=!0;var e,t=this.state,n=(e=void 0===t.prngstate?new Ee(t.seed,{state:!0}):new Ee("",{state:t.prngstate}))();return this.state=l(l({},t),{},{prngstate:e.state()}),n}},{key:"api",value:function(){var e=this._random.bind(this),t={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},n={},r=function(r){var o=t[r];n[r]=function(t){return void 0===t?Math.floor(e()*o)+1:p(new Array(t).keys()).map((function(){return Math.floor(e()*o)+1}))}};for(var o in t)r(o);return l(l({},n),{},{Die:function(t,n){return void 0===t&&(t=6),void 0===n?Math.floor(e()*t)+1:p(new Array(n).keys()).map((function(){return Math.floor(e()*t)+1}))},Number:function(){return e()},Shuffle:function(t){for(var n=t.slice(0),r=t.length,o=0,i=new Array(r);r;){var a=r*e()|0;i[o++]=n[a],n[a]=n[--r]}return i},_obj:this})}}]),e}();_e.seed=function(){return(+new Date).toString(36).slice(-10)};const De={name:"random",noClient:({api:e})=>e._obj.isUsed(),flush:({api:e})=>e._obj.getState(),api:({data:e})=>new _e(e).api(),setup:({game:e})=>{let t=e.seed;return void 0===t&&(t=_e.seed()),{seed:t}}};class je{constructor(e,t){this.flow=e,this.playerID=t,this.dispatch=[]}api(e){const t={_obj:this},{phase:n,turn:r}=e;for(const e of this.flow.eventNames)t[e]=(...t)=>{this.dispatch.push({key:e,args:t,phase:n,turn:r})};return t}isUsed(){return this.dispatch.length>0}update(e){for(let t=0;t<this.dispatch.length;t++){const n=this.dispatch[t];if("endTurn"===n.key&&n.turn!==e.ctx.turn)continue;if(("endPhase"===n.key||"setPhase"===n.key)&&n.phase!==e.ctx.phase)continue;const r=D(n.key,n.args,this.playerID);e={...e,...this.flow.processEvent(e,r)}}return e}}const Se=[Oe,De,{name:"events",noClient:({api:e})=>e._obj.isUsed(),dangerouslyFlushRawState:({state:e,api:t})=>t._obj.update(e),api:({game:e,playerID:t,ctx:n})=>new je(e.flow,t).api(n)}],Ae=e=>{let t={...e.ctx};const n=e.plugins||{};return Object.entries(n).forEach(([e,{api:n}])=>{t[e]=n}),t},Ce=(e,t)=>[...Se,...t].filter(e=>void 0!==e.fnWrap).reduce((e,{fnWrap:t})=>t(e),e),ze=(e,t)=>([...Se,...t.game.plugins].filter(e=>void 0!==e.api).forEach(n=>{const r=n.name,o=e.plugins[r]||{data:{}},i=n.api({G:e.G,ctx:e.ctx,data:o.data,game:t.game,playerID:t.playerID});e={...e,plugins:{...e.plugins,[r]:{...o,api:i}}}}),e),Me=(e,t)=>([...Se,...t.game.plugins].reverse().forEach(n=>{const r=n.name,o=e.plugins[r]||{data:{}};if(n.flush){const r=n.flush({G:e.G,ctx:e.ctx,game:t.game,api:o.api,data:o.data});e={...e,plugins:{...e.plugins,[n.name]:{data:r}}}}else if(n.dangerouslyFlushRawState){const i=(e=n.dangerouslyFlushRawState({state:e,game:t.game,api:o.api,data:o.data})).plugins[r].data;e={...e,plugins:{...e.plugins,[n.name]:{data:i}}}}}),e),Ne=console.log,qe=console.error;function Ge(e){qe("ERROR:",e)}function Te(e,t,n){return{...e,ctx:Be(e.ctx,n)}}function Be(e,t){let{_prevActivePlayers:n}=e,r={},o=null,i={};if(Array.isArray(t)){let e={};t.forEach(t=>e[t]=Ue.NULL),r=e}else{if(t.next&&(o=t.next),n=t.revert?n.concat({activePlayers:e.activePlayers,_activePlayersMoveLimit:e._activePlayersMoveLimit,_activePlayersNumMoves:e._activePlayersNumMoves}):[],void 0!==t.currentPlayer&&Le(r,i,e.currentPlayer,t.currentPlayer),void 0!==t.others)for(let n=0;n<e.playOrder.length;n++){const o=e.playOrder[n];o!==e.currentPlayer&&Le(r,i,o,t.others)}if(void 0!==t.all)for(let n=0;n<e.playOrder.length;n++){Le(r,i,e.playOrder[n],t.all)}if(t.value)for(const e in t.value)Le(r,i,e,t.value[e]);if(t.moveLimit)for(const e in r)void 0===i[e]&&(i[e]=t.moveLimit)}0==Object.keys(r).length&&(r=null),0==Object.keys(i).length&&(i=null);let a={};for(const e in r)a[e]=0;return{...e,activePlayers:r,_activePlayersMoveLimit:i,_activePlayersNumMoves:a,_prevActivePlayers:n,_nextActivePlayers:o}}function Le(e,t,n,r){"object"==typeof r&&r!==Ue.NULL||(r={stage:r}),void 0!==r.stage&&(e[n]=r.stage,r.moveLimit&&(t[n]=r.moveLimit))}function Re(e,t){return e[t]+""}const Fe={first:(e,t)=>0===t.turn?t.playOrderPos:(t.playOrderPos+1)%t.playOrder.length,next:(e,t)=>(t.playOrderPos+1)%t.playOrder.length},Ue={NULL:null};function Ve({moves:e,phases:t,endIf:n,onEnd:r,turn:o,events:i,plugins:a}){void 0===e&&(e={}),void 0===i&&(i={}),void 0===a&&(a=[]),void 0===t&&(t={}),n||(n=()=>{}),r||(r=e=>e),o||(o={});const l={...t};""in l&&Ge("cannot specify phase with empty name"),l[""]={};let s={},c=new Set,u=null;Object.keys(e).forEach(e=>c.add(e));const f=e=>{const t=Ce(e,a);return e=>{const n=Ae(e);return t(e.G,n)}},d=e=>t=>{let n=Ae(t);return e(t.G,n)},p={onEnd:f(r),endIf:d(n)};for(let e in l){const t=l[e];if(!0===t.start&&(u=e),void 0!==t.moves)for(let n of Object.keys(t.moves))s[e+"."+n]=t.moves[n],c.add(n);void 0===t.endIf&&(t.endIf=()=>{}),void 0===t.onBegin&&(t.onBegin=e=>e),void 0===t.onEnd&&(t.onEnd=e=>e),void 0===t.turn&&(t.turn=o),void 0===t.turn.order&&(t.turn.order=Fe),void 0===t.turn.onBegin&&(t.turn.onBegin=e=>e),void 0===t.turn.onEnd&&(t.turn.onEnd=e=>e),void 0===t.turn.endIf&&(t.turn.endIf=()=>!1),void 0===t.turn.onMove&&(t.turn.onMove=e=>e),void 0===t.turn.stages&&(t.turn.stages={});for(const n in t.turn.stages){const r=t.turn.stages[n].moves||{};for(let t of Object.keys(r)){s[e+"."+n+"."+t]=r[t],c.add(t)}}t.wrapped={onBegin:f(t.onBegin),onEnd:f(t.onEnd),endIf:d(t.endIf)},t.turn.wrapped={onMove:f(t.turn.onMove),onBegin:f(t.turn.onBegin),onEnd:f(t.turn.onEnd),endIf:d(t.turn.endIf)}}function v(e){return e.phase?l[e.phase]:l[""]}function h(e){return e}function m(e,t){const n=new Set,r=new Set;for(let o=0;o<t.length;o++){const{fn:i,arg:a,...l}=t[o];if(i===E){r.clear();const t=e.ctx.phase;if(n.has(t)){const t={...e.ctx,phase:null};return{...e,ctx:t}}n.add(t)}let s=[];if(e=i(e,{...l,arg:a,next:s}),i===I)break;const c=P(e);if(c){t.push({fn:I,arg:c,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});continue}const u=O(e);if(u)t.push({fn:E,arg:u,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});else{if(i===h){const n=k(e);if(n){t.push({fn:D,arg:n,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});continue}}t.push(...s)}}return e}function g(e,{next:t}){return t.push({fn:y}),e}function y(e,{next:t}){let{G:n,ctx:r}=e;return n=v(r).wrapped.onBegin(e),t.push({fn:b}),{...e,G:n,ctx:r}}function b(e,{currentPlayer:t}){let{G:n,ctx:r}=e;const o=v(r);t?(r={...r,currentPlayer:t},o.turn.activePlayers&&(r=Be(r,o.turn.activePlayers))):r=function(e,t){let{G:n,ctx:r}=e;const o=Ae(e),i=t.order;let a=[...new Array(r.numPlayers)].map((e,t)=>t+"");void 0!==i.playOrder&&(a=i.playOrder(n,o));const l=i.first(n,o),s=typeof l;"number"!==s&&Ge(`invalid value returned by turn.order.first — expected number got ${s} “${l}”.`);const c=Re(a,l);return r={...r,currentPlayer:c,playOrderPos:l,playOrder:a},r=Be(r,t.activePlayers||{}),r}(e,o.turn);const i=r.turn+1;r={...r,turn:i,numMoves:0,_prevActivePlayers:[]},n=o.turn.wrapped.onBegin({...e,G:n,ctx:r});const a=[{G:n,ctx:r}];return{...e,G:n,ctx:r,_undo:a,_redo:[]}}function x(e,{arg:t,next:n,phase:r}){const o=v({phase:r});let{ctx:i}=e;if(t&&t.next){if(!(t.next in l))return Ge("invalid phase: "+t.next),e;i={...i,phase:t.next}}else i=void 0!==o.next?{...i,phase:o.next}:{...i,phase:null};return e={...e,ctx:i},n.push({fn:y}),e}function w(e,{arg:t,currentPlayer:n,next:r}){let{G:o,ctx:i}=e;const a=v(i),{endPhase:l,ctx:s}=function(e,t,n,r){const o=n.order;let{G:i,ctx:a}=e,l=a.playOrderPos,s=!1;if(r&&!0!==r)"object"!=typeof r&&Ge("invalid argument to endTurn: "+r),Object.keys(r).forEach(e=>{switch(e){case"remove":t=Re(a.playOrder,l);break;case"next":l=a.playOrder.indexOf(r.next),t=r.next;break;default:Ge("invalid argument to endTurn: "+e)}});else{const n=Ae(e),r=o.next(i,n),c=typeof r;void 0!==r&&"number"!==c&&Ge(`invalid value returned by turn.order.next — expected number or undefined got ${c} “${r}”.`),void 0===r?s=!0:(l=r,t=Re(a.playOrder,l))}return a={...a,playOrderPos:l,currentPlayer:t},{endPhase:s,ctx:a}}(e,n,a.turn,t);return i=s,e={...e,G:o,ctx:i},l?r.push({fn:E,turn:i.turn,phase:i.phase}):r.push({fn:b,currentPlayer:i.currentPlayer}),e}function $(e,{arg:t,playerID:n}){"string"==typeof t&&(t={stage:t});let{ctx:r}=e,{activePlayers:o,_activePlayersMoveLimit:i,_activePlayersNumMoves:a}=r;return t.stage&&(null===o&&(o={}),o[n]=t.stage,a[n]=0,t.moveLimit&&(null===i&&(i={}),i[n]=t.moveLimit)),r={...r,activePlayers:o,_activePlayersMoveLimit:i,_activePlayersNumMoves:a},{...e,ctx:r}}function P(e){return p.endIf(e)}function O(e){return v(e.ctx).wrapped.endIf(e)}function k(e){const t=v(e.ctx),n=e.ctx.numMoves||0;return!!(t.turn.moveLimit&&n>=t.turn.moveLimit)||t.turn.wrapped.endIf(e)}function I(e,{arg:t,phase:n}){e=E(e,{phase:n}),void 0===t&&(t=!0),e={...e,ctx:{...e.ctx,gameover:t}};const r=p.onEnd(e);return{...e,G:r}}function E(e,{arg:t,next:n,turn:r,automatic:o}){let i=(e=D(e,{turn:r,force:!0})).G,a=e.ctx;if(n&&n.push({fn:x,arg:t,phase:a.phase}),null===a.phase)return e;i=v(a).wrapped.onEnd(e),a={...a,phase:null};const l={action:_("endPhase",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};o&&(l.automatic=!0);const s=[...e.deltalog,l];return{...e,G:i,ctx:a,deltalog:s}}function D(e,{arg:t,next:n,turn:r,force:o,automatic:i,playerID:a}){if(r!==e.ctx.turn)return e;let{G:l,ctx:s}=e;const c=v(s),u=s.numMoves||0;if(!o&&c.turn.moveLimit&&u<c.turn.moveLimit)return f=`cannot end turn before making ${c.turn.moveLimit} moves`,Ne("INFO: "+f),e;var f;if(l=c.turn.wrapped.onEnd(e),n&&n.push({fn:w,arg:t,currentPlayer:s.currentPlayer}),s={...s,activePlayers:null},t&&t.remove){a=a||s.currentPlayer;const t=s.playOrder.filter(e=>e!=a),r=s.playOrderPos>t.length-1?0:s.playOrderPos;if(s={...s,playOrder:t,playOrderPos:r},0===t.length)return n.push({fn:E,turn:s.turn,phase:s.phase}),e}const d={action:_("endTurn",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};i&&(d.automatic=!0);const p=[...e.deltalog||[],d];return{...e,G:l,ctx:s,deltalog:p,_undo:[],_redo:[]}}function j(e,{arg:t,next:n,automatic:r,playerID:o}){o=o||e.ctx.currentPlayer;let{ctx:i}=e,{activePlayers:a,_activePlayersMoveLimit:l}=i;const s=null!==a&&o in a;if(!t&&s){const e=v(i).turn.stages[a[o]];e&&e.next&&(t=e.next)}if(n&&t&&n.push({fn:$,arg:t,playerID:o}),!s)return e;a=Object.keys(a).filter(e=>e!==o).reduce((e,t)=>(e[t]=a[t],e),{}),l&&(l=Object.keys(l).filter(e=>e!==o).reduce((e,t)=>(e[t]=l[t],e),{})),i=function(e){let{activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:o}=e;if(t&&0==Object.keys(t).length)if(e._nextActivePlayers)e=Be(e,e._nextActivePlayers),({activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:o}=e);else if(o.length>0){const e=o.length-1;({activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r}=o[e]),o=o.slice(0,e)}else t=null,n=null;return{...e,activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:o}}({...i,activePlayers:a,_activePlayersMoveLimit:l});const c={action:_("endStage",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};r&&(c.automatic=!0);const u=[...e.deltalog||[],c];return{...e,ctx:i,deltalog:u}}function S(t,n,r){const o=v(t),i=o.turn.stages,{activePlayers:a}=t;if(a&&void 0!==a[r]&&a[r]!==Ue.NULL&&void 0!==i[a[r]]&&void 0!==i[a[r]].moves){const e=i[a[r]].moves;if(n in e)return e[n]}else if(o.moves){if(n in o.moves)return o.moves[n]}else if(n in e)return e[n];return null}const A={endStage:function(e,t){return m(e,[{fn:j,playerID:t}])},setStage:function(e,t,n){return m(e,[{fn:j,arg:n,playerID:t}])},endTurn:function(e,t,n){return m(e,[{fn:D,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},pass:function(e,t,n){return m(e,[{fn:D,turn:e.ctx.turn,phase:e.ctx.phase,force:!0,arg:n}])},endPhase:function(e){return m(e,[{fn:E,phase:e.ctx.phase,turn:e.ctx.turn}])},setPhase:function(e,t,n){return m(e,[{fn:E,phase:e.ctx.phase,turn:e.ctx.turn,arg:{next:n}}])},endGame:function(e,t,n){return m(e,[{fn:I,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},setActivePlayers:Te};let C=[];return!1!==i.endTurn&&C.push("endTurn"),!1!==i.pass&&C.push("pass"),!1!==i.endPhase&&C.push("endPhase"),!1!==i.setPhase&&C.push("setPhase"),!1!==i.endGame&&C.push("endGame"),!1!==i.setActivePlayers&&C.push("setActivePlayers"),!1!==i.endStage&&C.push("endStage"),!1!==i.setStage&&C.push("setStage"),{ctx:e=>({numPlayers:e,turn:0,currentPlayer:"0",playOrder:[...new Array(e)].map((e,t)=>t+""),playOrderPos:0,phase:u,activePlayers:null,players:[]}),init:e=>m(e,[{fn:g}]),isPlayerActive:function(e,t,n){return t.activePlayers?n in t.activePlayers:t.currentPlayer===n},eventHandlers:A,eventNames:Object.keys(A),enabledEventNames:C,moveMap:s,moveNames:[...c.values()],processMove:function(e,t){let n=v(e.ctx);const r=S(e.ctx,t.type,t.playerID),o=!r||"function"==typeof r||!0!==r.noLimit;let{ctx:i}=e,{_activePlayersNumMoves:a}=i;const{playerID:l}=t;let s=e.ctx.numMoves;o&&(l==e.ctx.currentPlayer&&s++,i.activePlayers&&a[l]++),e={...e,ctx:{...i,numMoves:s,_activePlayersNumMoves:a}},i._activePlayersMoveLimit&&a[l]>=i._activePlayersMoveLimit[l]&&(e=j(e,{playerID:l,automatic:!0}));const c=n.turn.wrapped.onMove(e),u=(e={...e,G:c})._undo||[],f=t.type;return m(e={...e,_undo:[...u,{G:e.G,ctx:e.ctx,moveType:f}],_redo:[]},[{fn:h}])},processEvent:function(e,t){const{type:n,playerID:r,args:o}=t.payload;if(A.hasOwnProperty(n)){const t=[e,r].concat(o);return A[n].apply({},t)}return e},getMove:S}}function Ke(e){if(function(e){return void 0!==e.processMove}(e))return e;if(void 0===e.name&&(e.name="default"),void 0===e.setup&&(e.setup=()=>({})),void 0===e.moves&&(e.moves={}),void 0===e.playerView&&(e.playerView=e=>e),void 0===e.plugins&&(e.plugins=[]),e.plugins.forEach(e=>{if(void 0===e.name)throw new Error("Plugin missing name attribute");if(e.name.includes(" "))throw new Error(e.name+": Plugin name must not include spaces")}),e.name.includes(" "))throw new Error(e.name+": Game name must not include spaces");const t=Ve(e);return{...e,flow:t,moveNames:t.moveNames,pluginNames:e.plugins.map(e=>e.name),processMove:(n,r)=>{let o=t.getMove(n.ctx,r.type,r.playerID);var i;if((i=o)instanceof Object&&void 0!==i.move&&(o=o.move),o instanceof Function){const t=Ce(o,e.plugins),i={...Ae(n),playerID:r.playerID};let a=[];return void 0!==r.args&&(a=a.concat(r.args)),t(n.G,i,...a)}return Ge("invalid move object: "+r.type),n.G}}}function Je(){}const He=e=>e;function We(e,t){for(const n in t)e[n]=t[n];return e}function Ye(e){return e()}function Qe(){return Object.create(null)}function Xe(e){e.forEach(Ye)}function Ze(e){return"function"==typeof e}function et(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function tt(e,...t){if(null==e)return Je;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function nt(e,t,n){e.$$.on_destroy.push(tt(t,n))}function rt(e,t,n,r){return e[1]&&r?We(n.ctx.slice(),e[1](r(t))):n.ctx}function ot(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}const it="undefined"!=typeof window;let at=it?()=>window.performance.now():()=>Date.now(),lt=it?e=>requestAnimationFrame(e):Je;const st=new Set;function ct(e){st.forEach(t=>{t.c(e)||(st.delete(t),t.f())}),0!==st.size&&lt(ct)}function ut(e,t){e.appendChild(t)}function ft(e,t,n){e.insertBefore(t,n||null)}function dt(e){e.parentNode.removeChild(e)}function pt(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function vt(e){return document.createElement(e)}function ht(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function mt(e){return document.createTextNode(e)}function gt(){return mt(" ")}function yt(){return mt("")}function bt(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function xt(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function wt(e,t){t=""+t,e.data!==t&&(e.data=t)}function $t(e,t){(null!=t||e.value)&&(e.value=t)}function Pt(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}function Ot(e,t,n){e.classList[n?"add":"remove"](t)}function kt(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const It=new Set;let Et,_t=0;function Dt(e,t,n,r,o,i,a,l=0){const s=16.666/r;let c="{\n";for(let e=0;e<=1;e+=s){const r=t+(n-t)*i(e);c+=100*e+`%{${a(r,1-r)}}\n`}const u=c+`100% {${a(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${l}`,d=e.ownerDocument;It.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(vt("style")).sheet),v=d.__svelte_rules||(d.__svelte_rules={});v[f]||(v[f]=!0,p.insertRule(`@keyframes ${f} ${u}`,p.cssRules.length));const h=e.style.animation||"";return e.style.animation=`${h?h+", ":""}${f} ${r}ms linear ${o}ms 1 both`,_t+=1,f}function jt(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-r.length;o&&(e.style.animation=r.join(", "),_t-=o,_t||lt(()=>{_t||(It.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),It.clear())}))}function St(e){Et=e}function At(){if(!Et)throw new Error("Function called outside component initialization");return Et}function Ct(e){At().$$.on_destroy.push(e)}function zt(){const e=At();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const o=kt(t,n);r.slice().forEach(t=>{t.call(e,o)})}}}function Mt(e,t){At().$$.context.set(e,t)}function Nt(e){return At().$$.context.get(e)}const qt=[],Gt=[],Tt=[],Bt=[],Lt=Promise.resolve();let Rt=!1;function Ft(e){Tt.push(e)}let Ut=!1;const Vt=new Set;function Kt(){if(!Ut){Ut=!0;do{for(let e=0;e<qt.length;e+=1){const t=qt[e];St(t),Jt(t.$$)}for(qt.length=0;Gt.length;)Gt.pop()();for(let e=0;e<Tt.length;e+=1){const t=Tt[e];Vt.has(t)||(Vt.add(t),t())}Tt.length=0}while(qt.length);for(;Bt.length;)Bt.pop()();Rt=!1,Ut=!1,Vt.clear()}}function Jt(e){if(null!==e.fragment){e.update(),Xe(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ft)}}let Ht;function Wt(e,t,n){e.dispatchEvent(kt(`${t?"intro":"outro"}${n}`))}const Yt=new Set;let Qt;function Xt(){Qt={r:0,c:[],p:Qt}}function Zt(){Qt.r||Xe(Qt.c),Qt=Qt.p}function en(e,t){e&&e.i&&(Yt.delete(e),e.i(t))}function tn(e,t,n,r){if(e&&e.o){if(Yt.has(e))return;Yt.add(e),Qt.c.push(()=>{Yt.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const nn={duration:0};function rn(e,t,n,r){let o=t(e,n),i=r?0:1,a=null,l=null,s=null;function c(){s&&jt(e,s)}function u(e,t){const n=e.b-i;return t*=Math.abs(n),{a:i,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function f(t){const{delay:n=0,duration:r=300,easing:f=He,tick:d=Je,css:p}=o||nn,v={start:at()+n,b:t};t||(v.group=Qt,Qt.r+=1),a?l=v:(p&&(c(),s=Dt(e,i,t,r,n,f,p)),t&&d(0,1),a=u(v,r),Ft(()=>Wt(e,t,"start")),function(e){let t;0===st.size&&lt(ct),new Promise(n=>{st.add(t={c:e,f:n})})}(t=>{if(l&&t>l.start&&(a=u(l,r),l=null,Wt(e,a.b,"start"),p&&(c(),s=Dt(e,i,a.b,a.duration,0,f,o.css))),a)if(t>=a.end)d(i=a.b,1-i),Wt(e,a.b,"end"),l||(a.b?c():--a.group.r||Xe(a.group.c)),a=null;else if(t>=a.start){const e=t-a.start;i=a.a+a.d*f(e/a.duration),d(i,1-i)}return!(!a&&!l)}))}return{run(e){Ze(o)?(Ht||(Ht=Promise.resolve(),Ht.then(()=>{Ht=null})),Ht).then(()=>{o=o(),f(e)}):f(e)},end(){c(),a=l=null}}}function on(e){e&&e.c()}function an(e,t,n){const{fragment:r,on_mount:o,on_destroy:i,after_update:a}=e.$$;r&&r.m(t,n),Ft(()=>{const t=o.map(Ye).filter(Ze);i?i.push(...t):Xe(t),e.$$.on_mount=[]}),a.forEach(Ft)}function ln(e,t){const n=e.$$;null!==n.fragment&&(Xe(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function sn(e,t){-1===e.$$.dirty[0]&&(qt.push(e),Rt||(Rt=!0,Lt.then(Kt)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function cn(e,t,n,r,o,i,a=[-1]){const l=Et;St(e);const s=t.props||{},c=e.$$={fragment:null,ctx:null,props:i,update:Je,not_equal:o,bound:Qe(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:Qe(),dirty:a};let u=!1;if(c.ctx=n?n(e,s,(t,n,...r)=>{const i=r.length?r[0]:n;return c.ctx&&o(c.ctx[t],c.ctx[t]=i)&&(c.bound[t]&&c.bound[t](i),u&&sn(e,t)),n}):[],c.update(),u=!0,Xe(c.before_update),c.fragment=!!r&&r(c.ctx),t.target){if(t.hydrate){const e=function(e){return Array.from(e.childNodes)}(t.target);c.fragment&&c.fragment.l(e),e.forEach(dt)}else c.fragment&&c.fragment.c();t.intro&&en(e.$$.fragment),an(e,t.target,t.anchor),Kt()}St(l)}class un{$destroy(){ln(this,1),this.$destroy=Je}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const fn=[];function dn(e,t=Je){let n;const r=[];function o(t){if(et(e,t)&&(e=t,n)){const t=!fn.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),fn.push(n,e)}if(t){for(let e=0;e<fn.length;e+=2)fn[e][0](fn[e+1]);fn.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(i,a=Je){const l=[i,a];return r.push(l),1===r.length&&(n=t(o)||Je),i(e),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(n(),n=null)}}}}function pn(e){const t=e-1;return t*t*t+1}function vn(e,{delay:t=0,duration:n=400,easing:r=pn,x:o=0,y:i=0,opacity:a=0}){const l=getComputedStyle(e),s=+l.opacity,c="none"===l.transform?"":l.transform,u=s*(1-a);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*o}px, ${(1-e)*i}px);\n\t\t\topacity: ${s-u*t}`}}function hn(e,t,n){const r=e.slice();return r[4]=t[n][0],r[5]=t[n][1].label,r}function mn(e){let t,n,r,o,i=e[5]+"";function a(...t){return e[3](e[4],...t)}return{c(){t=vt("div"),n=mt(i),r=gt(),xt(t,"class","menu-item svelte-19bfq8g"),Ot(t,"active",e[0]==e[4])},m(e,i,l){ft(e,t,i),ut(t,n),ut(t,r),l&&o(),o=bt(t,"click",a)},p(r,o){e=r,2&o&&i!==(i=e[5]+"")&&wt(n,i),3&o&&Ot(t,"active",e[0]==e[4])},d(e){e&&dt(t),o()}}}function gn(e){let t,n=Object.entries(e[1]).reverse(),r=[];for(let t=0;t<n.length;t+=1)r[t]=mn(hn(e,n,t));return{c(){t=vt("div");for(let e=0;e<r.length;e+=1)r[e].c();xt(t,"class","menu svelte-19bfq8g")},m(e,n){ft(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,[o]){if(7&o){let i;for(n=Object.entries(e[1]).reverse(),i=0;i<n.length;i+=1){const a=hn(e,n,i);r[i]?r[i].p(a,o):(r[i]=mn(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},i:Je,o:Je,d(e){e&&dt(t),pt(r,e)}}}function yn(e,t,n){let{pane:r}=t,{panes:o}=t;const i=zt();return e.$set=e=>{"pane"in e&&n(0,r=e.pane),"panes"in e&&n(1,o=e.panes)},[r,o,i,e=>i("change",e)]}class bn extends un{constructor(e){var t;super(),document.getElementById("svelte-19bfq8g-style")||((t=vt("style")).id="svelte-19bfq8g-style",t.textContent=".menu.svelte-19bfq8g{display:flex;margin-top:-10px;flex-direction:row;border:1px solid #ccc;border-radius:5px 5px 0 0;height:25px;line-height:25px;margin-right:-500px;transform-origin:bottom right;transform:rotate(-90deg) translate(0, -500px)}.menu-item.svelte-19bfq8g{line-height:25px;cursor:pointer;background:#fefefe;color:#555;padding-left:15px;padding-right:15px;text-align:center}.menu-item.svelte-19bfq8g:last-child{border-radius:0 5px 0 0}.menu-item.svelte-19bfq8g:first-child{border-radius:5px 0 0 0}.menu-item.active.svelte-19bfq8g{cursor:default;font-weight:bold;background:#ddd;color:#555}.menu-item.svelte-19bfq8g:hover{background:#ddd;color:#555}",ut(document.head,t)),cn(this,e,yn,gn,et,{pane:0,panes:1})}}function xn(e){let t,n;return{c(){t=vt("div"),n=mt(e[1]),xt(t,"class","label svelte-1olzq4i")},m(e,r){ft(e,t,r),ut(t,n)},p(e,t){2&t&&wt(n,e[1])},d(e){e&&dt(t)}}}function wn(e){let t,n,r,o,i,a=e[1]&&xn(e);return{c(){t=vt("div"),n=vt("div"),r=mt(e[0]),o=gt(),a&&a.c(),xt(n,"class","key-box svelte-1olzq4i"),xt(t,"class","key svelte-1olzq4i"),Ot(t,"active",e[2])},m(l,s,c){ft(l,t,s),ut(t,n),ut(n,r),ut(t,o),a&&a.m(t,null),c&&Xe(i),i=[bt(window,"keydown",e[5]),bt(n,"click",e[4])]},p(e,[n]){1&n&&wt(r,e[0]),e[1]?a?a.p(e,n):(a=xn(e),a.c(),a.m(t,null)):a&&(a.d(1),a=null),4&n&&Ot(t,"active",e[2])},i:Je,o:Je,d(e){e&&dt(t),a&&a.d(),Xe(i)}}}function $n(e,t,n){let r,{value:o}=t,{onPress:i=null}=t,{label:a=null}=t,{disable:l=!1}=t;const{disableHotkeys:s}=Nt("hotkeys");nt(e,s,e=>n(8,r=e));let c=!1;function u(){n(2,c=!1)}function f(){n(2,c=!0),setTimeout(u,200),i&&setTimeout(i,1)}return e.$set=e=>{"value"in e&&n(0,o=e.value),"onPress"in e&&n(6,i=e.onPress),"label"in e&&n(1,a=e.label),"disable"in e&&n(7,l=e.disable)},[o,a,c,s,f,function(e){r||l||e.ctrlKey||e.metaKey||e.key!=o||(e.preventDefault(),f())},i,l]}class Pn extends un{constructor(e){var t;super(),document.getElementById("svelte-1olzq4i-style")||((t=vt("style")).id="svelte-1olzq4i-style",t.textContent=".key.svelte-1olzq4i.svelte-1olzq4i{display:flex;flex-direction:row;align-items:center}.key-box.svelte-1olzq4i.svelte-1olzq4i{cursor:pointer;min-width:10px;padding-left:5px;padding-right:5px;height:20px;line-height:20px;text-align:center;border:1px solid #ccc;box-shadow:1px 1px 1px #888;background:#eee;color:#444}.key-box.svelte-1olzq4i.svelte-1olzq4i:hover{background:#ddd}.key.active.svelte-1olzq4i .key-box.svelte-1olzq4i{background:#ddd;border:1px solid #999;box-shadow:none}.label.svelte-1olzq4i.svelte-1olzq4i{margin-left:10px}",ut(document.head,t)),cn(this,e,$n,wn,et,{value:0,onPress:6,label:1,disable:7})}}function On(e){let t,n,r,o,i,a,l,s,c,u;return{c(){t=vt("div"),n=vt("span"),r=mt(e[2]),o=gt(),i=vt("span"),i.textContent="(",a=gt(),l=vt("span"),s=gt(),c=vt("span"),c.textContent=")",xt(l,"class","arg-field svelte-1mppqmp"),xt(l,"contenteditable",""),xt(t,"class","move svelte-1mppqmp"),Ot(t,"active",e[3])},m(f,d,p){var v;ft(f,t,d),ut(t,n),ut(n,r),ut(t,o),ut(t,i),ut(t,a),ut(t,l),e[9](l),ut(t,s),ut(t,c),p&&Xe(u),u=[bt(l,"blur",(function(){Ze(e[1])&&e[1].apply(this,arguments)})),bt(l,"keypress",(v=kn,function(e){return e.stopPropagation(),v.call(this,e)})),bt(l,"keydown",e[5]),bt(t,"click",(function(){Ze(e[0])&&e[0].apply(this,arguments)}))]},p(n,[o]){e=n,4&o&&wt(r,e[2]),8&o&&Ot(t,"active",e[3])},i:Je,o:Je,d(n){n&&dt(t),e[9](null),Xe(u)}}}const kn=()=>{};function In(e,t,n){let r,{Activate:o}=t,{Deactivate:i}=t,{name:a}=t,{active:l}=t;const s=zt();function c(){try{const e=r.innerText;let t=new Function(`return [${e}]`)();s("submit",t)}catch(e){s("error",e)}n(4,r.innerText="",r)}var u;return u=()=>{l?r.focus():r.blur()},At().$$.after_update.push(u),e.$set=e=>{"Activate"in e&&n(0,o=e.Activate),"Deactivate"in e&&n(1,i=e.Deactivate),"name"in e&&n(2,a=e.name),"active"in e&&n(3,l=e.active)},[o,i,a,l,r,function(e){"Enter"==e.key&&(e.preventDefault(),c()),"Escape"==e.key&&(e.preventDefault(),i())},void 0,s,c,function(e){Gt[e?"unshift":"push"](()=>{n(4,r=e)})}]}class En extends un{constructor(e){var t;super(),document.getElementById("svelte-1mppqmp-style")||((t=vt("style")).id="svelte-1mppqmp-style",t.textContent=".move.svelte-1mppqmp{display:flex;flex-direction:row;cursor:pointer;margin-left:10px;color:#666}.move.svelte-1mppqmp:hover{color:#333}.move.active.svelte-1mppqmp{color:#111;font-weight:bold}.arg-field.svelte-1mppqmp{outline:none;font-family:monospace}",ut(document.head,t)),cn(this,e,In,On,et,{Activate:0,Deactivate:1,name:2,active:3})}}function _n(e){let t,n;return{c(){t=vt("span"),n=mt(e[2]),xt(t,"class","move-error svelte-smqssc")},m(e,r){ft(e,t,r),ut(t,n)},p(e,t){4&t&&wt(n,e[2])},d(e){e&&dt(t)}}}function Dn(e){let t,n,r,o,i;const a=new Pn({props:{value:e[0],onPress:e[4]}}),l=new En({props:{Activate:e[4],Deactivate:e[5],name:e[1],active:e[3]}});l.$on("submit",e[6]),l.$on("error",e[7]);let s=e[2]&&_n(e);return{c(){t=vt("div"),n=vt("div"),on(a.$$.fragment),r=gt(),on(l.$$.fragment),o=gt(),s&&s.c(),xt(n,"class","wrapper svelte-smqssc")},m(e,c){ft(e,t,c),ut(t,n),an(a,n,null),ut(n,r),an(l,n,null),ut(t,o),s&&s.m(t,null),i=!0},p(e,[n]){const r={};1&n&&(r.value=e[0]),a.$set(r);const o={};2&n&&(o.name=e[1]),8&n&&(o.active=e[3]),l.$set(o),e[2]?s?s.p(e,n):(s=_n(e),s.c(),s.m(t,null)):s&&(s.d(1),s=null)},i(e){i||(en(a.$$.fragment,e),en(l.$$.fragment,e),i=!0)},o(e){tn(a.$$.fragment,e),tn(l.$$.fragment,e),i=!1},d(e){e&&dt(t),ln(a),ln(l),s&&s.d()}}}function jn(e,t,n){let{shortcut:r}=t,{name:o}=t,{fn:i}=t;const{disableHotkeys:a}=Nt("hotkeys");let l="",s=!1;function c(){a.set(!1),n(2,l=""),n(3,s=!1)}return e.$set=e=>{"shortcut"in e&&n(0,r=e.shortcut),"name"in e&&n(1,o=e.name),"fn"in e&&n(8,i=e.fn)},[r,o,l,s,function(){a.set(!0),n(3,s=!0)},c,function(e){n(2,l=""),c(),i.apply(this,e.detail)},function(e){n(2,l=e.detail),Ge(e.detail)},i]}class Sn extends un{constructor(e){var t;super(),document.getElementById("svelte-smqssc-style")||((t=vt("style")).id="svelte-smqssc-style",t.textContent=".move-error.svelte-smqssc{color:#a00;font-weight:bold}.wrapper.svelte-smqssc{display:flex;flex-direction:row;align-items:center}",ut(document.head,t)),cn(this,e,jn,Dn,et,{shortcut:0,name:1,fn:8})}}var An=function(e,t){return{parse:function(t){var n=JSON.parse(t,o).map(r),i=n[0];return"object"==typeof i&&i?function t(n,r,o){return Object.keys(o).reduce((function(o,i){var a=o[i];if(a instanceof e){var l=n[a];"object"!=typeof l||r.has(l)?o[i]=l:(r.add(l),o[i]=t(n,r,l))}return o}),o)}(n,new Set,i):i},stringify:function(e){for(var t,r=new Map,o=[],i=[],a=+n(r,o,e),l=function(e,i){if(t)return t=!t,i;switch(typeof i){case"object":if(null===i)return i;case"string":return r.get(i)||n(r,o,i)}return i};a<o.length;a++)t=!0,i[a]=JSON.stringify(o[a],l);return"["+i.join(",")+"]"}};function n(t,n,r){var o=e(n.push(r)-1);return t.set(r,o),o}function r(t){return t instanceof e?e(t):t}function o(t,n){return"string"==typeof n?new e(n):n}}(String);const Cn=An.parse,zn=An.stringify;function Mn(e){let t,n,r,o,i,a,l,s,c;const u=new Pn({props:{value:"1",onPress:e[0].reset,label:"reset"}}),f=new Pn({props:{value:"2",onPress:e[1],label:"save"}}),d=new Pn({props:{value:"3",onPress:e[2],label:"restore"}}),p=new Pn({props:{value:".",disable:!0,label:"hide"}});return{c(){t=vt("section"),n=vt("li"),on(u.$$.fragment),r=gt(),o=vt("li"),on(f.$$.fragment),i=gt(),a=vt("li"),on(d.$$.fragment),l=gt(),s=vt("li"),on(p.$$.fragment),xt(n,"class","svelte-1x2w9i0"),xt(o,"class","svelte-1x2w9i0"),xt(a,"class","svelte-1x2w9i0"),xt(s,"class","svelte-1x2w9i0"),xt(t,"id","debug-controls"),xt(t,"class","controls")},m(e,v){ft(e,t,v),ut(t,n),an(u,n,null),ut(t,r),ut(t,o),an(f,o,null),ut(t,i),ut(t,a),an(d,a,null),ut(t,l),ut(t,s),an(p,s,null),c=!0},p(e,[t]){const n={};1&t&&(n.onPress=e[0].reset),u.$set(n)},i(e){c||(en(u.$$.fragment,e),en(f.$$.fragment,e),en(d.$$.fragment,e),en(p.$$.fragment,e),c=!0)},o(e){tn(u.$$.fragment,e),tn(f.$$.fragment,e),tn(d.$$.fragment,e),tn(p.$$.fragment,e),c=!1},d(e){e&&dt(t),ln(u),ln(f),ln(d),ln(p)}}}function Nn(e,t,n){let{client:r}=t;return e.$set=e=>{"client"in e&&n(0,r=e.client)},[r,function(){const{G:e,ctx:t}=r.getState(),n=zn({G:e,ctx:t});window.localStorage.setItem("gamestate",n)},function(){const e=window.localStorage.getItem("gamestate");if(null!==e){const t=Cn(e);r.store.dispatch(j(t))}}]}class qn extends un{constructor(e){var t;super(),document.getElementById("svelte-1x2w9i0-style")||((t=vt("style")).id="svelte-1x2w9i0-style",t.textContent="li.svelte-1x2w9i0{list-style:none;margin:none;margin-bottom:5px}",ut(document.head,t)),cn(this,e,Nn,Mn,et,{client:0})}}function Gn(e,t,n){const r=e.slice();return r[6]=t[n],r}function Tn(e){let t,n,r,o,i=e[6]+"";function a(...t){return e[5](e[6],...t)}return{c(){t=vt("div"),n=mt(i),r=gt(),xt(t,"class","player svelte-6sf87x"),Ot(t,"current",e[6]==e[0].currentPlayer),Ot(t,"active",e[6]==e[1])},m(e,i,l){ft(e,t,i),ut(t,n),ut(t,r),l&&o(),o=bt(t,"click",a)},p(r,o){e=r,4&o&&i!==(i=e[6]+"")&&wt(n,i),5&o&&Ot(t,"current",e[6]==e[0].currentPlayer),6&o&&Ot(t,"active",e[6]==e[1])},d(e){e&&dt(t),o()}}}function Bn(e){let t,n=e[2],r=[];for(let t=0;t<n.length;t+=1)r[t]=Tn(Gn(e,n,t));return{c(){t=vt("div");for(let e=0;e<r.length;e+=1)r[e].c();xt(t,"class","player-box svelte-6sf87x")},m(e,n){ft(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,[o]){if(15&o){let i;for(n=e[2],i=0;i<n.length;i+=1){const a=Gn(e,n,i);r[i]?r[i].p(a,o):(r[i]=Tn(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},i:Je,o:Je,d(e){e&&dt(t),pt(r,e)}}}function Ln(e,t,n){let{ctx:r}=t,{playerID:o}=t;const i=zt();function a(e){i("change",e==o?{playerID:null}:{playerID:e})}let l;return e.$set=e=>{"ctx"in e&&n(0,r=e.ctx),"playerID"in e&&n(1,o=e.playerID)},e.$$.update=()=>{1&e.$$.dirty&&n(2,l=r?[...Array(r.numPlayers).keys()].map(e=>e.toString()):[])},[r,o,l,a,i,e=>a(e)]}class Rn extends un{constructor(e){var t;super(),document.getElementById("svelte-6sf87x-style")||((t=vt("style")).id="svelte-6sf87x-style",t.textContent=".player-box.svelte-6sf87x{display:flex;flex-direction:row}.player.svelte-6sf87x{cursor:pointer;text-align:center;width:30px;height:30px;line-height:30px;background:#eee;border:3px solid #fefefe;box-sizing:content-box}.player.current.svelte-6sf87x{background:#555;color:#eee;font-weight:bold}.player.active.svelte-6sf87x{border:3px solid #ff7f50}",ut(document.head,t)),cn(this,e,Ln,Bn,et,{ctx:0,playerID:1})}}function Fn(e,t,n){const r=e.slice();return r[9]=t[n][0],r[10]=t[n][1],r}function Un(e){let t,n,r;const o=new Sn({props:{shortcut:e[4][e[9]],fn:e[10],name:e[9]}});return{c(){t=vt("li"),on(o.$$.fragment),n=gt(),xt(t,"class","svelte-1vg2l2b")},m(e,i){ft(e,t,i),an(o,t,null),ut(t,n),r=!0},p(e,t){const n={};1&t&&(n.shortcut=e[4][e[9]]),1&t&&(n.fn=e[10]),1&t&&(n.name=e[9]),o.$set(n)},i(e){r||(en(o.$$.fragment,e),r=!0)},o(e){tn(o.$$.fragment,e),r=!1},d(e){e&&dt(t),ln(o)}}}function Vn(e){let t,n;return{c(){t=vt("button"),t.textContent="End Turn",xt(t,"class","svelte-1vg2l2b")},m(r,o,i){ft(r,t,o),i&&n(),n=bt(t,"click",e[6])},p:Je,d(e){e&&dt(t),n()}}}function Kn(e){let t,n;return{c(){t=vt("button"),t.textContent="End Phase",xt(t,"class","svelte-1vg2l2b")},m(r,o,i){ft(r,t,o),i&&n(),n=bt(t,"click",e[7])},p:Je,d(e){e&&dt(t),n()}}}function Jn(e){let t,n;return{c(){t=vt("button"),t.textContent="End Stage",xt(t,"class","svelte-1vg2l2b")},m(r,o,i){ft(r,t,o),i&&n(),n=bt(t,"click",e[8])},p:Je,d(e){e&&dt(t),n()}}}function Hn(e){let t,n,r,o,i,a,l,s,c,u,f,d,p,v,h,m,g,y,b,x,w,$,P,O,k,I,E,_,D,j,S,A=JSON.stringify(e[3],null,2)+"",C=JSON.stringify(Wn(e[2]),null,2)+"";const z=new qn({props:{client:e[0]}}),M=new Rn({props:{ctx:e[2],playerID:e[1]}});M.$on("change",e[5]);let N=Object.entries(e[0].moves),q=[];for(let t=0;t<N.length;t+=1)q[t]=Un(Fn(e,N,t));const G=e=>tn(q[e],1,1,()=>{q[e]=null});let T=e[0].events.endTurn&&Vn(e),B=e[2].phase&&e[0].events.endPhase&&Kn(e),L=e[2].activePlayers&&e[0].events.endStage&&Jn(e);return{c(){t=vt("section"),n=vt("h3"),n.textContent="Controls",r=gt(),on(z.$$.fragment),o=gt(),i=vt("section"),a=vt("h3"),a.textContent="Players",l=gt(),on(M.$$.fragment),s=gt(),c=vt("section"),u=vt("h3"),u.textContent="Moves",f=gt();for(let e=0;e<q.length;e+=1)q[e].c();d=gt(),p=vt("section"),v=vt("h3"),v.textContent="Events",h=gt(),m=vt("div"),T&&T.c(),g=gt(),B&&B.c(),y=gt(),L&&L.c(),b=gt(),x=vt("section"),w=vt("label"),w.textContent="G",$=gt(),P=vt("pre"),O=mt(A),k=gt(),I=vt("section"),E=vt("label"),E.textContent="ctx",_=gt(),D=vt("pre"),j=mt(C),xt(n,"class","svelte-1vg2l2b"),xt(a,"class","svelte-1vg2l2b"),xt(u,"class","svelte-1vg2l2b"),xt(v,"class","svelte-1vg2l2b"),xt(m,"class","events svelte-1vg2l2b"),xt(w,"class","svelte-1vg2l2b"),xt(P,"class","json svelte-1vg2l2b"),xt(E,"class","svelte-1vg2l2b"),xt(D,"class","json svelte-1vg2l2b")},m(e,A){ft(e,t,A),ut(t,n),ut(t,r),an(z,t,null),ft(e,o,A),ft(e,i,A),ut(i,a),ut(i,l),an(M,i,null),ft(e,s,A),ft(e,c,A),ut(c,u),ut(c,f);for(let e=0;e<q.length;e+=1)q[e].m(c,null);ft(e,d,A),ft(e,p,A),ut(p,v),ut(p,h),ut(p,m),T&&T.m(m,null),ut(m,g),B&&B.m(m,null),ut(m,y),L&&L.m(m,null),ft(e,b,A),ft(e,x,A),ut(x,w),ut(x,$),ut(x,P),ut(P,O),ft(e,k,A),ft(e,I,A),ut(I,E),ut(I,_),ut(I,D),ut(D,j),S=!0},p(e,[t]){const n={};1&t&&(n.client=e[0]),z.$set(n);const r={};if(4&t&&(r.ctx=e[2]),2&t&&(r.playerID=e[1]),M.$set(r),17&t){let n;for(N=Object.entries(e[0].moves),n=0;n<N.length;n+=1){const r=Fn(e,N,n);q[n]?(q[n].p(r,t),en(q[n],1)):(q[n]=Un(r),q[n].c(),en(q[n],1),q[n].m(c,null))}for(Xt(),n=N.length;n<q.length;n+=1)G(n);Zt()}e[0].events.endTurn?T?T.p(e,t):(T=Vn(e),T.c(),T.m(m,g)):T&&(T.d(1),T=null),e[2].phase&&e[0].events.endPhase?B?B.p(e,t):(B=Kn(e),B.c(),B.m(m,y)):B&&(B.d(1),B=null),e[2].activePlayers&&e[0].events.endStage?L?L.p(e,t):(L=Jn(e),L.c(),L.m(m,null)):L&&(L.d(1),L=null),(!S||8&t)&&A!==(A=JSON.stringify(e[3],null,2)+"")&&wt(O,A),(!S||4&t)&&C!==(C=JSON.stringify(Wn(e[2]),null,2)+"")&&wt(j,C)},i(e){if(!S){en(z.$$.fragment,e),en(M.$$.fragment,e);for(let e=0;e<N.length;e+=1)en(q[e]);S=!0}},o(e){tn(z.$$.fragment,e),tn(M.$$.fragment,e),q=q.filter(Boolean);for(let e=0;e<q.length;e+=1)tn(q[e]);S=!1},d(e){e&&dt(t),ln(z),e&&dt(o),e&&dt(i),ln(M),e&&dt(s),e&&dt(c),pt(q,e),e&&dt(d),e&&dt(p),T&&T.d(),B&&B.d(),L&&L.d(),e&&dt(b),e&&dt(x),e&&dt(k),e&&dt(I)}}}function Wn(e){let t={};for(const n in e)n.startsWith("_")||(t[n]=e[n]);return t}function Yn(e,t,n){let{client:r}=t;const o=function(e,t,n){var r={},o={};for(var i in e)o[i]=i;for(var a in t)o[a]=a;for(var l={},s=0;s<n.length;s++){l[n[s]]=!0}var c=l,u=!0;for(var f in o){var d=f[0];if(c[d]){u=!1;break}c[d]=!0,r[f]=d}if(u)return r;c=l;var p=97;for(var v in r={},o){for(var h=String.fromCharCode(p);c[h];)p++,h=String.fromCharCode(p);c[h]=!0,r[v]=h}return r}(r.moves,r.events,"mlia");let i=r.playerID,a={},l={};r.subscribe(e=>{e&&(n(3,l=e.G),n(2,a=e.ctx)),n(1,i=r.playerID)});return e.$set=e=>{"client"in e&&n(0,r=e.client)},[r,i,a,l,o,e=>r.updatePlayerID(e.detail.playerID),()=>r.events.endTurn(),()=>r.events.endPhase(),()=>r.events.endStage()]}class Qn extends un{constructor(e){var t;super(),document.getElementById("svelte-1vg2l2b-style")||((t=vt("style")).id="svelte-1vg2l2b-style",t.textContent=".json.svelte-1vg2l2b.svelte-1vg2l2b{font-family:monospace;color:#888}label.svelte-1vg2l2b.svelte-1vg2l2b{font-weight:bold;font-size:1.1em;display:inline}h3.svelte-1vg2l2b.svelte-1vg2l2b{text-transform:uppercase}li.svelte-1vg2l2b.svelte-1vg2l2b{list-style:none;margin:none;margin-bottom:5px}.events.svelte-1vg2l2b.svelte-1vg2l2b{display:flex;flex-direction:column}.events.svelte-1vg2l2b button.svelte-1vg2l2b{width:100px}.events.svelte-1vg2l2b button.svelte-1vg2l2b:not(:last-child){margin-bottom:10px}",ut(document.head,t)),cn(this,e,Yn,Hn,et,{client:0})}}function Xn(e){let t,n,r,o,i,a,l=JSON.stringify(e[1])+"";return{c(){t=vt("div"),n=vt("strong"),r=mt(e[0]),o=gt(),i=vt("div"),a=mt(l),xt(i,"class","svelte-13qih23"),xt(t,"class","item svelte-13qih23")},m(e,l){ft(e,t,l),ut(t,n),ut(n,r),ut(t,o),ut(t,i),ut(i,a)},p(e,[t]){1&t&&wt(r,e[0]),2&t&&l!==(l=JSON.stringify(e[1])+"")&&wt(a,l)},i:Je,o:Je,d(e){e&&dt(t)}}}function Zn(e,t,n){let{name:r}=t,{value:o}=t;return e.$set=e=>{"name"in e&&n(0,r=e.name),"value"in e&&n(1,o=e.value)},[r,o]}class er extends un{constructor(e){var t;super(),document.getElementById("svelte-13qih23-style")||((t=vt("style")).id="svelte-13qih23-style",t.textContent=".item.svelte-13qih23.svelte-13qih23{padding:10px}.item.svelte-13qih23.svelte-13qih23:not(:first-child){border-top:1px dashed #aaa}.item.svelte-13qih23 div.svelte-13qih23{float:right;text-align:right}",ut(document.head,t)),cn(this,e,Zn,Xn,et,{name:0,value:1})}}function tr(e){let t,n,r;const o=new er({props:{name:"isConnected",value:e[1].isConnected}}),i=new er({props:{name:"isMultiplayer",value:e[1].isMultiplayer}});return{c(){t=vt("span"),on(o.$$.fragment),n=gt(),on(i.$$.fragment)},m(e,a){ft(e,t,a),an(o,t,null),ut(t,n),an(i,t,null),r=!0},p(e,t){const n={};2&t&&(n.value=e[1].isConnected),o.$set(n);const r={};2&t&&(r.value=e[1].isMultiplayer),i.$set(r)},i(e){r||(en(o.$$.fragment,e),en(i.$$.fragment,e),r=!0)},o(e){tn(o.$$.fragment,e),tn(i.$$.fragment,e),r=!1},d(e){e&&dt(t),ln(o),ln(i)}}}function nr(e){let t,n,r,o,i;const a=new er({props:{name:"gameID",value:e[0].gameID}}),l=new er({props:{name:"playerID",value:e[0].playerID}}),s=new er({props:{name:"isActive",value:e[1].isActive}});let c=e[1].isMultiplayer&&tr(e);return{c(){t=vt("section"),on(a.$$.fragment),n=gt(),on(l.$$.fragment),r=gt(),on(s.$$.fragment),o=gt(),c&&c.c(),xt(t,"class","gameinfo svelte-1yzq5o8")},m(e,u){ft(e,t,u),an(a,t,null),ut(t,n),an(l,t,null),ut(t,r),an(s,t,null),ut(t,o),c&&c.m(t,null),i=!0},p(e,[n]){const r={};1&n&&(r.value=e[0].gameID),a.$set(r);const o={};1&n&&(o.value=e[0].playerID),l.$set(o);const i={};2&n&&(i.value=e[1].isActive),s.$set(i),e[1].isMultiplayer?c?(c.p(e,n),2&n&&en(c,1)):(c=tr(e),c.c(),en(c,1),c.m(t,null)):c&&(Xt(),tn(c,1,1,()=>{c=null}),Zt())},i(e){i||(en(a.$$.fragment,e),en(l.$$.fragment,e),en(s.$$.fragment,e),en(c),i=!0)},o(e){tn(a.$$.fragment,e),tn(l.$$.fragment,e),tn(s.$$.fragment,e),tn(c),i=!1},d(e){e&&dt(t),ln(a),ln(l),ln(s),c&&c.d()}}}function rr(e,t,n){let r,o=Je,i=()=>(o(),o=tt(a,e=>n(1,r=e)),a);e.$$.on_destroy.push(()=>o());let{client:a}=t;return i(),e.$set=e=>{"client"in e&&i(n(0,a=e.client))},[a,r]}class or extends un{constructor(e){var t;super(),document.getElementById("svelte-1yzq5o8-style")||((t=vt("style")).id="svelte-1yzq5o8-style",t.textContent=".gameinfo.svelte-1yzq5o8{padding:10px}",ut(document.head,t)),cn(this,e,rr,nr,et,{client:0})}}function ir(e){let t,n;return{c(){t=vt("div"),n=mt(e[0]),xt(t,"class","turn-marker svelte-6eza86"),xt(t,"style",e[1])},m(e,r){ft(e,t,r),ut(t,n)},p(e,[t]){1&t&&wt(n,e[0])},i:Je,o:Je,d(e){e&&dt(t)}}}function ar(e,t,n){let{turn:r}=t,{numEvents:o}=t;const i="grid-row: span "+o;return e.$set=e=>{"turn"in e&&n(0,r=e.turn),"numEvents"in e&&n(2,o=e.numEvents)},[r,i,o]}class lr extends un{constructor(e){var t;super(),document.getElementById("svelte-6eza86-style")||((t=vt("style")).id="svelte-6eza86-style",t.textContent=".turn-marker.svelte-6eza86{display:flex;justify-content:center;align-items:center;grid-column:1;background:#555;color:#eee;text-align:center;font-weight:bold;border:1px solid #888}",ut(document.head,t)),cn(this,e,ar,ir,et,{turn:0,numEvents:2})}}function sr(e){let t,n,r=(e[0]||"")+"";return{c(){t=vt("div"),n=mt(r),xt(t,"class","phase-marker svelte-1t4xap"),xt(t,"style",e[1])},m(e,r){ft(e,t,r),ut(t,n)},p(e,[t]){1&t&&r!==(r=(e[0]||"")+"")&&wt(n,r)},i:Je,o:Je,d(e){e&&dt(t)}}}function cr(e,t,n){let{phase:r}=t,{numEvents:o}=t;const i="grid-row: span "+o;return e.$set=e=>{"phase"in e&&n(0,r=e.phase),"numEvents"in e&&n(2,o=e.numEvents)},[r,i,o]}class ur extends un{constructor(e){var t;super(),document.getElementById("svelte-1t4xap-style")||((t=vt("style")).id="svelte-1t4xap-style",t.textContent=".phase-marker.svelte-1t4xap{grid-column:3;background:#555;border:1px solid #888;color:#eee;text-align:center;font-weight:bold;padding-top:10px;padding-bottom:10px;text-orientation:sideways;writing-mode:vertical-rl;line-height:30px;width:100%}",ut(document.head,t)),cn(this,e,cr,sr,et,{phase:0,numEvents:2})}}function fr(e){let t;return{c(){t=vt("div"),t.textContent=""+e[0]},m(e,n){ft(e,t,n)},p:Je,i:Je,o:Je,d(e){e&&dt(t)}}}function dr(e,t,n){let{payload:r}=t;const o=void 0!==r?JSON.stringify(r,null,4):"";return e.$set=e=>{"payload"in e&&n(1,r=e.payload)},[o,r]}class pr extends un{constructor(e){super(),cn(this,e,dr,fr,et,{payload:1})}}function vr(e){let t;const n=new pr({props:{payload:e[3]}});return{c(){on(n.$$.fragment)},m(e,r){an(n,e,r),t=!0},p(e,t){const r={};8&t&&(r.payload=e[3]),n.$set(r)},i(e){t||(en(n.$$.fragment,e),t=!0)},o(e){tn(n.$$.fragment,e),t=!1},d(e){ln(n,e)}}}function hr(e){let t,n;var r=e[4];function o(e){return{props:{payload:e[3]}}}if(r)var i=new r(o(e));return{c(){i&&on(i.$$.fragment),t=yt()},m(e,r){i&&an(i,e,r),ft(e,t,r),n=!0},p(e,n){const a={};if(8&n&&(a.payload=e[3]),r!==(r=e[4])){if(i){Xt();const e=i;tn(e.$$.fragment,1,0,()=>{ln(e,1)}),Zt()}r?(on((i=new r(o(e))).$$.fragment),en(i.$$.fragment,1),an(i,t.parentNode,t)):i=null}else r&&i.$set(a)},i(e){n||(i&&en(i.$$.fragment,e),n=!0)},o(e){i&&tn(i.$$.fragment,e),n=!1},d(e){e&&dt(t),i&&ln(i,e)}}}function mr(e){let t,n,r,o,i,a,l,s,c,u,f,d,p=e[1].payload.type+"",v=e[6].join(",")+"";const h=[hr,vr],m=[];function g(e,t){return e[4]?0:1}return s=g(e),c=m[s]=h[s](e),{c(){t=vt("div"),n=vt("div"),r=mt(p),o=mt("("),i=mt(v),a=mt(")"),l=gt(),c.c(),xt(t,"class",u="log-event player"+e[7]+" svelte-10wdo7v"),Ot(t,"pinned",e[2])},m(c,u,p){ft(c,t,u),ut(t,n),ut(n,r),ut(n,o),ut(n,i),ut(n,a),ut(t,l),m[s].m(t,null),f=!0,p&&Xe(d),d=[bt(t,"click",e[8]),bt(t,"mouseenter",e[9]),bt(t,"mouseleave",e[10])]},p(e,[n]){(!f||2&n)&&p!==(p=e[1].payload.type+"")&&wt(r,p);let o=s;s=g(e),s===o?m[s].p(e,n):(Xt(),tn(m[o],1,1,()=>{m[o]=null}),Zt(),c=m[s],c||(c=m[s]=h[s](e),c.c()),en(c,1),c.m(t,null)),4&n&&Ot(t,"pinned",e[2])},i(e){f||(en(c),f=!0)},o(e){tn(c),f=!1},d(e){e&&dt(t),m[s].d(),Xe(d)}}}function gr(e,t,n){let{logIndex:r}=t,{action:o}=t,{pinned:i}=t,{payload:a}=t,{payloadComponent:l}=t;const s=zt(),c=o.payload.args||[],u=o.payload.playerID;return e.$set=e=>{"logIndex"in e&&n(0,r=e.logIndex),"action"in e&&n(1,o=e.action),"pinned"in e&&n(2,i=e.pinned),"payload"in e&&n(3,a=e.payload),"payloadComponent"in e&&n(4,l=e.payloadComponent)},[r,o,i,a,l,s,c,u,()=>s("click",{logIndex:r}),()=>s("mouseenter",{logIndex:r}),()=>s("mouseleave")]}class yr extends un{constructor(e){var t;super(),document.getElementById("svelte-10wdo7v-style")||((t=vt("style")).id="svelte-10wdo7v-style",t.textContent=".log-event.svelte-10wdo7v{grid-column:2;cursor:pointer;overflow:hidden;display:flex;flex-direction:column;justify-content:center;background:#fff;border:1px dotted #ccc;border-left:5px solid #ccc;padding:5px;text-align:center;color:#888;font-size:14px;min-height:25px;line-height:25px}.log-event.svelte-10wdo7v:hover{border-style:solid;background:#eee}.log-event.pinned.svelte-10wdo7v{border-style:solid;background:#eee;opacity:1}.player0.svelte-10wdo7v{border-left-color:#ff851b}.player1.svelte-10wdo7v{border-left-color:#7fdbff}.player2.svelte-10wdo7v{border-left-color:#0074d9}.player3.svelte-10wdo7v{border-left-color:#39cccc}.player4.svelte-10wdo7v{border-left-color:#3d9970}.player5.svelte-10wdo7v{border-left-color:#2ecc40}.player6.svelte-10wdo7v{border-left-color:#01ff70}.player7.svelte-10wdo7v{border-left-color:#ffdc00}.player8.svelte-10wdo7v{border-left-color:#001f3f}.player9.svelte-10wdo7v{border-left-color:#ff4136}.player10.svelte-10wdo7v{border-left-color:#85144b}.player11.svelte-10wdo7v{border-left-color:#f012be}.player12.svelte-10wdo7v{border-left-color:#b10dc9}.player13.svelte-10wdo7v{border-left-color:#111111}.player14.svelte-10wdo7v{border-left-color:#aaaaaa}.player15.svelte-10wdo7v{border-left-color:#dddddd}",ut(document.head,t)),cn(this,e,gr,mr,et,{logIndex:0,action:1,pinned:2,payload:3,payloadComponent:4})}}function br(e){let t,n;return{c(){t=ht("title"),n=mt(e[0])},m(e,r){ft(e,t,r),ut(t,n)},p(e,t){1&t&&wt(n,e[0])},d(e){e&&dt(t)}}}function xr(e){let t,n,r,o=e[0]&&br(e);const i=e[3].default,a=function(e,t,n,r){if(e){const o=rt(e,t,n,r);return e[0](o)}}(i,e,e[2],null);return{c(){t=ht("svg"),o&&o.c(),n=yt(),a&&a.c(),xt(t,"xmlns","http://www.w3.org/2000/svg"),xt(t,"viewBox",e[1]),xt(t,"class","svelte-c8tyih")},m(e,i){ft(e,t,i),o&&o.m(t,null),ut(t,n),a&&a.m(t,null),r=!0},p(e,[l]){e[0]?o?o.p(e,l):(o=br(e),o.c(),o.m(t,n)):o&&(o.d(1),o=null),a&&a.p&&4&l&&a.p(rt(i,e,e[2],null),function(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}(i,e[2],l,null)),(!r||2&l)&&xt(t,"viewBox",e[1])},i(e){r||(en(a,e),r=!0)},o(e){tn(a,e),r=!1},d(e){e&&dt(t),o&&o.d(),a&&a.d(e)}}}function wr(e,t,n){let{title:r=null}=t,{viewBox:o}=t,{$$slots:i={},$$scope:a}=t;return e.$set=e=>{"title"in e&&n(0,r=e.title),"viewBox"in e&&n(1,o=e.viewBox),"$$scope"in e&&n(2,a=e.$$scope)},[r,o,a,i]}class $r extends un{constructor(e){var t;super(),document.getElementById("svelte-c8tyih-style")||((t=vt("style")).id="svelte-c8tyih-style",t.textContent="svg.svelte-c8tyih{stroke:currentColor;fill:currentColor;stroke-width:0;width:100%;height:auto;max-height:100%}",ut(document.head,t)),cn(this,e,wr,xr,et,{title:0,viewBox:1})}}function Pr(e){let t;return{c(){t=ht("path"),xt(t,"d","M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zM212 140v116h-70.9c-10.7 0-16.1 13-8.5 20.5l114.9 114.3c4.7 4.7 12.2 4.7 16.9 0l114.9-114.3c7.6-7.6 2.2-20.5-8.5-20.5H300V140c0-6.6-5.4-12-12-12h-64c-6.6 0-12 5.4-12 12z")},m(e,n){ft(e,t,n)},d(e){e&&dt(t)}}}function Or(e){let t;const n=[{viewBox:"0 0 512 512"},e[0]];let r={$$slots:{default:[Pr]},$$scope:{ctx:e}};for(let e=0;e<n.length;e+=1)r=We(r,n[e]);const o=new $r({props:r});return{c(){on(o.$$.fragment)},m(e,n){an(o,e,n),t=!0},p(e,[t]){const r=1&t?function(e,t){const n={},r={},o={$$scope:1};let i=e.length;for(;i--;){const a=e[i],l=t[i];if(l){for(const e in a)e in l||(r[e]=1);for(const e in l)o[e]||(n[e]=l[e],o[e]=1);e[i]=l}else for(const e in a)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}(n,[n[0],(i=e[0],"object"==typeof i&&null!==i?i:{})]):{};var i;2&t&&(r.$$scope={dirty:t,ctx:e}),o.$set(r)},i(e){t||(en(o.$$.fragment,e),t=!0)},o(e){tn(o.$$.fragment,e),t=!1},d(e){ln(o,e)}}}function kr(e,t,n){return e.$set=e=>{n(0,t=We(We({},t),ot(e)))},[t=ot(t)]}class Ir extends un{constructor(e){super(),cn(this,e,kr,Or,et,{})}}function Er(e){let t,n;return{c(){t=vt("div"),n=mt(e[0]),xt(t,"alt",e[0]),xt(t,"class","svelte-1a7time")},m(e,r){ft(e,t,r),ut(t,n)},p(e,[r]){1&r&&wt(n,e[0]),1&r&&xt(t,"alt",e[0])},i:Je,o:Je,d(e){e&&dt(t)}}}function _r(e,t,n){let r,{action:o}=t;return e.$set=e=>{"action"in e&&n(1,o=e.action)},e.$$.update=()=>{if(2&e.$$.dirty){const{type:e,args:t}=o.payload,i=(t||[]).join(",");n(0,r=`${e}(${i})`)}},[r,o]}class Dr extends un{constructor(e){var t;super(),document.getElementById("svelte-1a7time-style")||((t=vt("style")).id="svelte-1a7time-style",t.textContent="div.svelte-1a7time{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:500px}",ut(document.head,t)),cn(this,e,_r,Er,et,{action:1})}}function jr(e,t,n){const r=e.slice();return r[10]=t[n],r[12]=n,r}function Sr(e){let t,n,r,o,i,a,l,s,c,u,f,d=e[10].value+"",p=e[10].visits+"";const v=new Dr({props:{action:e[10].parentAction}});function h(...t){return e[7](e[10],e[12],...t)}function m(...t){return e[8](e[12],...t)}function g(...t){return e[9](e[10],e[12],...t)}return{c(){t=vt("tr"),n=vt("td"),r=mt(d),o=gt(),i=vt("td"),a=mt(p),l=gt(),s=vt("td"),on(v.$$.fragment),c=gt(),xt(n,"class","svelte-ztcwsu"),xt(i,"class","svelte-ztcwsu"),xt(s,"class","svelte-ztcwsu"),xt(t,"class","svelte-ztcwsu"),Ot(t,"clickable",e[1].length>0),Ot(t,"selected",e[12]===e[0])},m(e,d,p){ft(e,t,d),ut(t,n),ut(n,r),ut(t,o),ut(t,i),ut(i,a),ut(t,l),ut(t,s),an(v,s,null),ut(t,c),u=!0,p&&Xe(f),f=[bt(t,"click",h),bt(t,"mouseout",m),bt(t,"mouseover",g)]},p(n,o){e=n,(!u||2&o)&&d!==(d=e[10].value+"")&&wt(r,d),(!u||2&o)&&p!==(p=e[10].visits+"")&&wt(a,p);const i={};2&o&&(i.action=e[10].parentAction),v.$set(i),2&o&&Ot(t,"clickable",e[1].length>0),1&o&&Ot(t,"selected",e[12]===e[0])},i(e){u||(en(v.$$.fragment,e),u=!0)},o(e){tn(v.$$.fragment,e),u=!1},d(e){e&&dt(t),ln(v),Xe(f)}}}function Ar(e){let t,n,r,o,i,a=e[1],l=[];for(let t=0;t<a.length;t+=1)l[t]=Sr(jr(e,a,t));const s=e=>tn(l[e],1,1,()=>{l[e]=null});return{c(){t=vt("table"),n=vt("thead"),n.innerHTML='<th class="svelte-ztcwsu">Value</th> \n    <th class="svelte-ztcwsu">Visits</th> \n    <th class="svelte-ztcwsu">Action</th>',r=gt(),o=vt("tbody");for(let e=0;e<l.length;e+=1)l[e].c();xt(t,"class","svelte-ztcwsu")},m(e,a){ft(e,t,a),ut(t,n),ut(t,r),ut(t,o);for(let e=0;e<l.length;e+=1)l[e].m(o,null);i=!0},p(e,[t]){if(15&t){let n;for(a=e[1],n=0;n<a.length;n+=1){const r=jr(e,a,n);l[n]?(l[n].p(r,t),en(l[n],1)):(l[n]=Sr(r),l[n].c(),en(l[n],1),l[n].m(o,null))}for(Xt(),n=a.length;n<l.length;n+=1)s(n);Zt()}},i(e){if(!i){for(let e=0;e<a.length;e+=1)en(l[e]);i=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)tn(l[e]);i=!1},d(e){e&&dt(t),pt(l,e)}}}function Cr(e,t,n){let{root:r}=t,{selectedIndex:o=null}=t;const i=zt();let a=[],l=[];function s(e,t){i("select",{node:e,selectedIndex:t})}function c(e,t){null===o&&i("preview",{node:e})}return e.$set=e=>{"root"in e&&n(4,r=e.root),"selectedIndex"in e&&n(0,o=e.selectedIndex)},e.$$.update=()=>{if(48&e.$$.dirty){let e=r;for(n(5,a=[]);e.parent;){const t=e.parent,{type:n,args:r}=e.parentAction.payload,o=`${n}(${(r||[]).join(",")})`;a.push({parent:t,arrowText:o}),e=t}a.reverse(),n(1,l=[...r.children].sort((e,t)=>e.visits<t.visits?1:-1).slice(0,50))}},[o,l,s,c,r,a,i,(e,t)=>s(e,t),e=>c(null),(e,t)=>c(e)]}class zr extends un{constructor(e){var t;super(),document.getElementById("svelte-ztcwsu-style")||((t=vt("style")).id="svelte-ztcwsu-style",t.textContent="table.svelte-ztcwsu.svelte-ztcwsu{font-size:12px;border-collapse:collapse;border:1px solid #ddd;padding:0}tr.svelte-ztcwsu.svelte-ztcwsu{cursor:pointer}tr.svelte-ztcwsu:hover td.svelte-ztcwsu{background:#eee}tr.selected.svelte-ztcwsu td.svelte-ztcwsu{background:#eee}td.svelte-ztcwsu.svelte-ztcwsu{padding:10px;height:10px;line-height:10px;font-size:12px;border:none}th.svelte-ztcwsu.svelte-ztcwsu{background:#888;color:#fff;padding:10px;text-align:center}",ut(document.head,t)),cn(this,e,Cr,Ar,et,{root:4,selectedIndex:0})}}function Mr(e,t,n){const r=e.slice();return r[9]=t[n].node,r[10]=t[n].selectedIndex,r[12]=n,r}function Nr(e){let t;const n=new zr({props:{root:e[9],selectedIndex:e[10]}});return n.$on("select",(function(...t){return e[8](e[12],...t)})),{c(){on(n.$$.fragment)},m(e,r){an(n,e,r),t=!0},p(t,r){e=t;const o={};1&r&&(o.root=e[9]),1&r&&(o.selectedIndex=e[10]),n.$set(o)},i(e){t||(en(n.$$.fragment,e),t=!0)},o(e){tn(n.$$.fragment,e),t=!1},d(e){ln(n,e)}}}function qr(e){let t;const n=new zr({props:{root:e[9]}});return n.$on("select",(function(...t){return e[6](e[12],...t)})),n.$on("preview",(function(...t){return e[7](e[12],...t)})),{c(){on(n.$$.fragment)},m(e,r){an(n,e,r),t=!0},p(t,r){e=t;const o={};1&r&&(o.root=e[9]),n.$set(o)},i(e){t||(en(n.$$.fragment,e),t=!0)},o(e){tn(n.$$.fragment,e),t=!1},d(e){ln(n,e)}}}function Gr(e){let t,n,r,o,i,a=0!==e[12]&&function(e){let t,n;const r=new Ir({});return{c(){t=vt("div"),on(r.$$.fragment),xt(t,"class","icon svelte-1f0amz4")},m(e,o){ft(e,t,o),an(r,t,null),n=!0},i(e){n||(en(r.$$.fragment,e),n=!0)},o(e){tn(r.$$.fragment,e),n=!1},d(e){e&&dt(t),ln(r)}}}();const l=[qr,Nr],s=[];function c(e,t){return e[12]===e[0].length-1?0:1}return r=c(e),o=s[r]=l[r](e),{c(){a&&a.c(),t=gt(),n=vt("section"),o.c()},m(e,o){a&&a.m(e,o),ft(e,t,o),ft(e,n,o),s[r].m(n,null),i=!0},p(e,t){let i=r;r=c(e),r===i?s[r].p(e,t):(Xt(),tn(s[i],1,1,()=>{s[i]=null}),Zt(),o=s[r],o||(o=s[r]=l[r](e),o.c()),en(o,1),o.m(n,null))},i(e){i||(en(a),en(o),i=!0)},o(e){tn(a),tn(o),i=!1},d(e){a&&a.d(e),e&&dt(t),e&&dt(n),s[r].d()}}}function Tr(e){let t,n,r,o;const i=new Ir({}),a=new zr({props:{root:e[1]}});return{c(){t=vt("div"),on(i.$$.fragment),n=gt(),r=vt("section"),on(a.$$.fragment),xt(t,"class","icon svelte-1f0amz4"),xt(r,"class","preview svelte-1f0amz4")},m(e,l){ft(e,t,l),an(i,t,null),ft(e,n,l),ft(e,r,l),an(a,r,null),o=!0},p(e,t){const n={};2&t&&(n.root=e[1]),a.$set(n)},i(e){o||(en(i.$$.fragment,e),en(a.$$.fragment,e),o=!0)},o(e){tn(i.$$.fragment,e),tn(a.$$.fragment,e),o=!1},d(e){e&&dt(t),ln(i),e&&dt(n),e&&dt(r),ln(a)}}}function Br(e){let t,n,r,o=e[0],i=[];for(let t=0;t<o.length;t+=1)i[t]=Gr(Mr(e,o,t));const a=e=>tn(i[e],1,1,()=>{i[e]=null});let l=e[1]&&Tr(e);return{c(){t=vt("div");for(let e=0;e<i.length;e+=1)i[e].c();n=gt(),l&&l.c(),xt(t,"class","visualizer svelte-1f0amz4")},m(e,o){ft(e,t,o);for(let e=0;e<i.length;e+=1)i[e].m(t,null);ut(t,n),l&&l.m(t,null),r=!0},p(e,[r]){if(13&r){let l;for(o=e[0],l=0;l<o.length;l+=1){const a=Mr(e,o,l);i[l]?(i[l].p(a,r),en(i[l],1)):(i[l]=Gr(a),i[l].c(),en(i[l],1),i[l].m(t,n))}for(Xt(),l=o.length;l<i.length;l+=1)a(l);Zt()}e[1]?l?(l.p(e,r),2&r&&en(l,1)):(l=Tr(e),l.c(),en(l,1),l.m(t,null)):l&&(Xt(),tn(l,1,1,()=>{l=null}),Zt())},i(e){if(!r){for(let e=0;e<o.length;e+=1)en(i[e]);en(l),r=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)tn(i[e]);tn(l),r=!1},d(e){e&&dt(t),pt(i,e),l&&l.d()}}}function Lr(e,t,n){let{metadata:r}=t,o=[],i=[],a=null;function l({node:e,selectedIndex:t},r){n(1,a=null),n(0,o[r].selectedIndex=t,o),n(0,o=[...o.slice(0,r+1),{node:e}])}function s({node:e},t){n(1,a=e)}return e.$set=e=>{"metadata"in e&&n(4,r=e.metadata)},e.$$.update=()=>{16&e.$$.dirty&&(i=[],n(0,o=[{node:r}]))},[o,a,l,s,r,i,(e,t)=>l(t.detail,e),(e,t)=>s(t.detail),(e,t)=>l(t.detail,e)]}class Rr extends un{constructor(e){var t;super(),document.getElementById("svelte-1f0amz4-style")||((t=vt("style")).id="svelte-1f0amz4-style",t.textContent=".visualizer.svelte-1f0amz4{display:flex;flex-direction:column;align-items:center;padding:50px}.preview.svelte-1f0amz4{opacity:0.5}.icon.svelte-1f0amz4{color:#777;width:32px;height:32px;margin-bottom:20px}",ut(document.head,t)),cn(this,e,Lr,Br,et,{metadata:4})}}function Fr(e,t,n){const r=e.slice();return r[15]=t[n].phase,r[17]=n,r}function Ur(e,t,n){const r=e.slice();return r[18]=t[n].action,r[19]=t[n].payload,r[17]=n,r}function Vr(e,t,n){const r=e.slice();return r[21]=t[n].turn,r[17]=n,r}function Kr(e){let t;const n=new lr({props:{turn:e[21],numEvents:e[3][e[17]]}});return{c(){on(n.$$.fragment)},m(e,r){an(n,e,r),t=!0},p(e,t){const r={};4&t&&(r.turn=e[21]),8&t&&(r.numEvents=e[3][e[17]]),n.$set(r)},i(e){t||(en(n.$$.fragment,e),t=!0)},o(e){tn(n.$$.fragment,e),t=!1},d(e){ln(n,e)}}}function Jr(e){let t,n,r=e[17]in e[3]&&Kr(e);return{c(){r&&r.c(),t=yt()},m(e,o){r&&r.m(e,o),ft(e,t,o),n=!0},p(e,n){e[17]in e[3]?r?(r.p(e,n),8&n&&en(r,1)):(r=Kr(e),r.c(),en(r,1),r.m(t.parentNode,t)):r&&(Xt(),tn(r,1,1,()=>{r=null}),Zt())},i(e){n||(en(r),n=!0)},o(e){tn(r),n=!1},d(e){r&&r.d(e),e&&dt(t)}}}function Hr(e){let t;const n=new yr({props:{pinned:e[17]===e[1],logIndex:e[17],action:e[18],payload:e[19]}});return n.$on("click",e[5]),n.$on("mouseenter",e[6]),n.$on("mouseleave",e[7]),{c(){on(n.$$.fragment)},m(e,r){an(n,e,r),t=!0},p(e,t){const r={};2&t&&(r.pinned=e[17]===e[1]),4&t&&(r.action=e[18]),4&t&&(r.payload=e[19]),n.$set(r)},i(e){t||(en(n.$$.fragment,e),t=!0)},o(e){tn(n.$$.fragment,e),t=!1},d(e){ln(n,e)}}}function Wr(e){let t;const n=new ur({props:{phase:e[15],numEvents:e[4][e[17]]}});return{c(){on(n.$$.fragment)},m(e,r){an(n,e,r),t=!0},p(e,t){const r={};4&t&&(r.phase=e[15]),16&t&&(r.numEvents=e[4][e[17]]),n.$set(r)},i(e){t||(en(n.$$.fragment,e),t=!0)},o(e){tn(n.$$.fragment,e),t=!1},d(e){ln(n,e)}}}function Yr(e){let t,n,r=e[17]in e[4]&&Wr(e);return{c(){r&&r.c(),t=yt()},m(e,o){r&&r.m(e,o),ft(e,t,o),n=!0},p(e,n){e[17]in e[4]?r?(r.p(e,n),16&n&&en(r,1)):(r=Wr(e),r.c(),en(r,1),r.m(t.parentNode,t)):r&&(Xt(),tn(r,1,1,()=>{r=null}),Zt())},i(e){n||(en(r),n=!0)},o(e){tn(r),n=!1},d(e){r&&r.d(e),e&&dt(t)}}}function Qr(e){let t,n,r,o,i,a=e[2],l=[];for(let t=0;t<a.length;t+=1)l[t]=Jr(Vr(e,a,t));const s=e=>tn(l[e],1,1,()=>{l[e]=null});let c=e[2],u=[];for(let t=0;t<c.length;t+=1)u[t]=Hr(Ur(e,c,t));const f=e=>tn(u[e],1,1,()=>{u[e]=null});let d=e[2],p=[];for(let t=0;t<d.length;t+=1)p[t]=Yr(Fr(e,d,t));const v=e=>tn(p[e],1,1,()=>{p[e]=null});return{c(){t=vt("div");for(let e=0;e<l.length;e+=1)l[e].c();n=gt();for(let e=0;e<u.length;e+=1)u[e].c();r=gt();for(let e=0;e<p.length;e+=1)p[e].c();xt(t,"class","gamelog svelte-1pq5e4b"),Ot(t,"pinned",e[1])},m(a,s,c){ft(a,t,s);for(let e=0;e<l.length;e+=1)l[e].m(t,null);ut(t,n);for(let e=0;e<u.length;e+=1)u[e].m(t,null);ut(t,r);for(let e=0;e<p.length;e+=1)p[e].m(t,null);o=!0,c&&i(),i=bt(window,"keydown",e[8])},p(e,[o]){if(12&o){let r;for(a=e[2],r=0;r<a.length;r+=1){const i=Vr(e,a,r);l[r]?(l[r].p(i,o),en(l[r],1)):(l[r]=Jr(i),l[r].c(),en(l[r],1),l[r].m(t,n))}for(Xt(),r=a.length;r<l.length;r+=1)s(r);Zt()}if(230&o){let n;for(c=e[2],n=0;n<c.length;n+=1){const i=Ur(e,c,n);u[n]?(u[n].p(i,o),en(u[n],1)):(u[n]=Hr(i),u[n].c(),en(u[n],1),u[n].m(t,r))}for(Xt(),n=c.length;n<u.length;n+=1)f(n);Zt()}if(20&o){let n;for(d=e[2],n=0;n<d.length;n+=1){const r=Fr(e,d,n);p[n]?(p[n].p(r,o),en(p[n],1)):(p[n]=Yr(r),p[n].c(),en(p[n],1),p[n].m(t,null))}for(Xt(),n=d.length;n<p.length;n+=1)v(n);Zt()}2&o&&Ot(t,"pinned",e[1])},i(e){if(!o){for(let e=0;e<a.length;e+=1)en(l[e]);for(let e=0;e<c.length;e+=1)en(u[e]);for(let e=0;e<d.length;e+=1)en(p[e]);o=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)tn(l[e]);u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)tn(u[e]);p=p.filter(Boolean);for(let e=0;e<p.length;e+=1)tn(p[e]);o=!1},d(e){e&&dt(t),pt(l,e),pt(u,e),pt(p,e),i()}}}function Xr(e,t,n){let r,o=Je,i=()=>(o(),o=tt(a,e=>n(10,r=e)),a);e.$$.on_destroy.push(()=>o());let{client:a}=t;i();const{secondaryPane:l}=Nt("secondaryPane"),s=a.getInitialState();let c,{log:u}=r,f=null;function d(e){let t=s;for(let n=0;n<u.length;n++){const{action:r,automatic:o}=u[n];if(o||(t=a.reducer(t,r)),"MAKE_MOVE"==r.type){if(0==e)break;e--}}return{G:t.G,ctx:t.ctx}}function p(){n(1,f=null),a.overrideGameState(null),l.set(null)}Ct(p);let v={},h={};return e.$set=e=>{"client"in e&&i(n(0,a=e.client))},e.$$.update=()=>{if(1540&e.$$.dirty){n(9,u=r.log),n(2,c=u.filter(e=>"MAKE_MOVE"==e.action.type));let e=0,t=0;n(3,v={}),n(4,h={});for(let r=0;r<c.length;r++){const{action:o,payload:i,turn:a,phase:l}=c[r];t++,e++,r!=c.length-1&&c[r+1].turn==a||(n(3,v[r]=t,v),t=0),r!=c.length-1&&c[r+1].phase==l||(n(4,h[r]=e,h),e=0)}}},[a,f,c,v,h,function(e){const{logIndex:t}=e.detail,r=d(t),o=u.filter(e=>"MAKE_MOVE"==e.action.type);if(a.overrideGameState(r),f==t)n(1,f=null),l.set(null);else{n(1,f=t);const{metadata:e}=o[t].action.payload;e&&l.set({component:Rr,metadata:e})}},function(e){const{logIndex:t}=e.detail;if(null===f){const e=d(t);a.overrideGameState(e)}},function(){null===f&&a.overrideGameState(null)},function(e){27==e.keyCode&&p()}]}class Zr extends un{constructor(e){var t;super(),document.getElementById("svelte-1pq5e4b-style")||((t=vt("style")).id="svelte-1pq5e4b-style",t.textContent=".gamelog.svelte-1pq5e4b{display:grid;grid-template-columns:30px 1fr 30px;grid-auto-rows:auto;grid-auto-flow:column}",ut(document.head,t)),cn(this,e,Xr,Qr,et,{client:0})}}function eo(e,t,n){const r=e.slice();return r[5]=t[n][0],r[6]=t[n][1],r}function to(e){let t,n,r,o,i,a,l,s=e[1][e[5]]+"";function c(){e[3].call(o,e[5])}return{c(){t=vt("span"),n=mt(s),r=gt(),o=vt("input"),xt(t,"class","value svelte-7cel4i"),xt(o,"type","range"),xt(o,"min",i=e[6].range.min),xt(o,"max",a=e[6].range.max)},m(i,a,s){ft(i,t,a),ut(t,n),ft(i,r,a),ft(i,o,a),$t(o,e[1][e[5]]),s&&Xe(l),l=[bt(o,"change",c),bt(o,"input",c),bt(o,"change",e[2])]},p(t,r){e=t,3&r&&s!==(s=e[1][e[5]]+"")&&wt(n,s),1&r&&i!==(i=e[6].range.min)&&xt(o,"min",i),1&r&&a!==(a=e[6].range.max)&&xt(o,"max",a),3&r&&$t(o,e[1][e[5]])},d(e){e&&dt(t),e&&dt(r),e&&dt(o),Xe(l)}}}function no(e){let t,n;function r(){e[4].call(t,e[5])}return{c(){t=vt("input"),xt(t,"type","checkbox"),xt(t,"class","svelte-7cel4i")},m(o,i,a){ft(o,t,i),t.checked=e[1][e[5]],a&&Xe(n),n=[bt(t,"change",r),bt(t,"change",e[2])]},p(n,r){e=n,3&r&&(t.checked=e[1][e[5]])},d(e){e&&dt(t),Xe(n)}}}function ro(e){let t,n,r,o,i,a,l=e[5]+"",s=e[6].range&&to(e),c="boolean"==typeof e[6].value&&no(e);return{c(){t=vt("div"),n=vt("label"),r=mt(l),o=gt(),s&&s.c(),i=gt(),c&&c.c(),a=gt(),xt(n,"class","svelte-7cel4i"),xt(t,"class","option svelte-7cel4i")},m(e,l){ft(e,t,l),ut(t,n),ut(n,r),ut(t,o),s&&s.m(t,null),ut(t,i),c&&c.m(t,null),ut(t,a)},p(e,n){1&n&&l!==(l=e[5]+"")&&wt(r,l),e[6].range?s?s.p(e,n):(s=to(e),s.c(),s.m(t,i)):s&&(s.d(1),s=null),"boolean"==typeof e[6].value?c?c.p(e,n):(c=no(e),c.c(),c.m(t,a)):c&&(c.d(1),c=null)},d(e){e&&dt(t),s&&s.d(),c&&c.d()}}}function oo(e){let t,n=Object.entries(e[0].opts()),r=[];for(let t=0;t<n.length;t+=1)r[t]=ro(eo(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=yt()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);ft(e,t,n)},p(e,[o]){if(7&o){let i;for(n=Object.entries(e[0].opts()),i=0;i<n.length;i+=1){const a=eo(e,n,i);r[i]?r[i].p(a,o):(r[i]=ro(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},i:Je,o:Je,d(e){pt(r,e),e&&dt(t)}}}function io(e,t,n){let{bot:r}=t,o={};for(let[e,t]of Object.entries(r.opts()))o[e]=t.value;return e.$set=e=>{"bot"in e&&n(0,r=e.bot)},[r,o,function(){for(let[e,t]of Object.entries(o))r.setOpt(e,t)},function(e){o[e]=function(e){return""===e?void 0:+e}(this.value),n(1,o),n(0,r)},function(e){o[e]=this.checked,n(1,o),n(0,r)}]}class ao extends un{constructor(e){var t;super(),document.getElementById("svelte-7cel4i-style")||((t=vt("style")).id="svelte-7cel4i-style",t.textContent="label.svelte-7cel4i{font-weight:bold;color:#999}.option.svelte-7cel4i{margin-bottom:20px}.value.svelte-7cel4i{font-weight:bold}input[type='checkbox'].svelte-7cel4i{vertical-align:middle}",ut(document.head,t)),cn(this,e,io,oo,et,{bot:0})}}function lo({game:e,isClient:t}){return e=Ke(e),(n=null,r)=>{switch(r.type){case"GAME_EVENT":{if(n={...n,deltalog:[]},t)return n;if(void 0!==n.ctx.gameover)return Ge("cannot call event after game end"),n;if(null!==r.payload.playerID&&void 0!==r.payload.playerID&&!e.flow.isPlayerActive(n.G,n.ctx,r.payload.playerID))return Ge("disallowed event: "+r.payload.type),n;n=ze(n,{game:e,isClient:!1,playerID:r.payload.playerID});let o=e.flow.processEvent(n,r);return o=Me(o,{game:e,isClient:!1}),{...o,_stateID:n._stateID+1}}case"MAKE_MOVE":{n={...n,deltalog:[]};const o=e.flow.getMove(n.ctx,r.payload.type,r.payload.playerID||n.ctx.currentPlayer);if(null===o)return Ge("disallowed move: "+r.payload.type),n;if(t&&!1===o.client)return n;if(void 0!==n.ctx.gameover)return Ge("cannot make move after game end"),n;if(null!==r.payload.playerID&&void 0!==r.payload.playerID&&!e.flow.isPlayerActive(n.G,n.ctx,r.payload.playerID))return Ge("disallowed move: "+r.payload.type),n;n=ze(n,{game:e,isClient:t,playerID:r.payload.playerID});let i=e.processMove(n,r.payload);if("INVALID_MOVE"===i)return Ge(`invalid move: ${r.payload.type} args: ${r.payload.args}`),n;let a={action:r,_stateID:n._stateID,turn:n.ctx.turn,phase:n.ctx.phase};!0===o.redact&&(a.redact=!0);const l={...n,G:i,deltalog:[a],_stateID:n._stateID+1};return t&&((e,t)=>[...Se,...t.game.plugins].filter(e=>void 0!==e.noClient).map(n=>{const r=n.name,o=e.plugins[r];return!!o&&n.noClient({G:e.G,ctx:e.ctx,game:t.game,api:o.api,data:o.data})}).some(e=>!0===e))(l,{game:e})?n:(n=l,t?n=Me(n,{game:e,isClient:!0}):(n=e.flow.processMove(n,r.payload),n=Me(n,{game:e})))}case"RESET":case"UPDATE":case"SYNC":return r.state;case"UNDO":{const{_undo:t,_redo:r}=n;if(t.length<2)return n;const l=t[t.length-1],s=t[t.length-2],c=e.flow.getMove(n.ctx,l.moveType,n.ctx.currentPlayer);return o=n.G,i=n.ctx,function(e){return void 0!==e.undoable}(a=c)&&!(a.undoable instanceof Function?a.undoable(o,i):a.undoable)?n:{...n,G:s.G,ctx:s.ctx,_undo:t.slice(0,t.length-1),_redo:[l,...r]}}case"REDO":{const{_undo:e,_redo:t}=n;if(0==t.length)return n;const r=t[0];return{...n,G:r.G,ctx:r.ctx,_undo:[...e,r],_redo:t.slice(1)}}case"PLUGIN":return((e,t,n)=>(n.game.plugins.filter(e=>void 0!==e.action).filter(e=>e.name===t.payload.type).forEach(n=>{const r=n.name,o=e.plugins[r]||{data:{}},i=n.action(o.data,t.payload);e={...e,plugins:{...e.plugins,[r]:{...o,data:i}}}}),e))(n,r,{game:e});default:return n}var o,i,a}}var so=function(){function e(t){var r=this,o=t.enumerate,a=t.seed;n(this,e),i(this,"enumerate",(function(e,t,n){return r.enumerateFn(e,t,n).map((function(e){return void 0!==e.payload?e:void 0!==e.move?E(e.move,e.args,n):void 0!==e.event?_(e.event,e.args,n):void 0}))})),this.enumerateFn=o,this.seed=a,this.iterationCounter=0,this._opts={}}return o(e,[{key:"addOpt",value:function(e){var t=e.key,n=e.range,r=e.initial;this._opts[t]={range:n,value:r}}},{key:"getOpt",value:function(e){return this._opts[e].value}},{key:"setOpt",value:function(e,t){e in this._opts&&(this._opts[e].value=t)}},{key:"opts",value:function(){return this._opts}},{key:"random",value:function(e){var t;if(void 0!==this.seed){var n=null;t=(n=this.prngstate?new Ee("",{state:this.prngstate}):new Ee(this.seed,{state:!0}))(),this.prngstate=n.state()}else t=Math.random();return e?e.length?e[Math.floor(t*e.length)]:Math.floor(t*e):t}}]),e}(),co=function(e){s(i,e);var r=d(i);function i(e){var t,o=e.enumerate,a=e.seed,l=e.objectives,s=e.game,c=e.iterations,u=e.playoutDepth,f=e.iterationCallback;return n(this,i),void 0===l&&(l=function(){return{}}),(t=r.call(this,{enumerate:o,seed:a})).objectives=l,t.iterationCallback=f||function(){},t.reducer=lo({game:s}),t.iterations=c,t.playoutDepth=u,t.addOpt({key:"async",initial:!1}),t.addOpt({key:"iterations",initial:"number"==typeof c?c:1e3,range:{min:1,max:2e3}}),t.addOpt({key:"playoutDepth",initial:"number"==typeof u?u:50,range:{min:1,max:100}}),t}return o(i,[{key:"createNode",value:function(e){var t=e.state,n=e.parentAction,r=e.parent,o=e.playerID,i=t.G,a=t.ctx,l=[],s=[];if(void 0!==o)l=this.enumerate(i,a,o),s=this.objectives(i,a,o);else if(a.activePlayers)for(var c in a.activePlayers)l=l.concat(this.enumerate(i,a,c)),s=s.concat(this.objectives(i,a,c));else l=l.concat(this.enumerate(i,a,a.currentPlayer)),s=s.concat(this.objectives(i,a,a.currentPlayer));return{state:t,parent:r,parentAction:n,actions:l,objectives:s,children:[],visits:0,value:0}}},{key:"select",value:function(e){if(e.actions.length>0)return e;if(0==e.children.length)return e;var t,n=null,r=0,o=m(e.children);try{for(o.s();!(t=o.n()).done;){var i=t.value,a=i.visits+Number.EPSILON,l=i.value/a+Math.sqrt(2*Math.log(e.visits)/a);(null==n||l>r)&&(r=l,n=i)}}catch(e){o.e(e)}finally{o.f()}return this.select(n)}},{key:"expand",value:function(e){var t=e.actions;if(0==t.length||void 0!==e.state.ctx.gameover)return e;var n=this.random(t.length),r=t[n];e.actions.splice(n,1);var o=this.reducer(e.state,r),i=this.createNode({state:o,parentAction:r,parent:e});return e.children.push(i),i}},{key:"playout",value:function(e){var n=this,r=e.state,o=this.getOpt("playoutDepth");"function"==typeof this.playoutDepth&&(o=this.playoutDepth(r.G,r.ctx));for(var i=function(e){var t=r,o=t.G,i=t.ctx,a=i.currentPlayer;i.activePlayers&&(a=Object.keys(i.activePlayers)[0]);var l=n.enumerate(o,i,a),s=n.objectives(o,i),c=Object.keys(s).reduce((function(e,t){var n=s[t];return n.checker(o,i)?e+n.weight:e}),0);if(c>0)return{v:{score:c}};if(!l||0==l.length)return{v:void 0};var u=n.random(l.length),f=n.reducer(r,l[u]);r=f},a=0;a<o&&void 0===r.ctx.gameover;a++){var l=i();if("object"===t(l))return l.v}return r.ctx.gameover}},{key:"backpropagate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.visits++,void 0!==t.score&&(e.value+=t.score),!0===t.draw&&(e.value+=.5),e.parentAction&&t.winner===e.parentAction.payload.playerID&&e.value++,e.parent&&this.backpropagate(e.parent,t)}},{key:"play",value:function(e,t){var n=this,r=this.createNode({state:e,playerID:t}),o=this.getOpt("iterations");"function"==typeof this.iterations&&(o=this.iterations(e.G,e.ctx));var i=function(){var e,t=null,n=m(r.children);try{for(n.s();!(e=n.n()).done;){var o=e.value;(null==t||o.visits>t.visits)&&(t=o)}}catch(e){n.e(e)}finally{n.f()}return{action:t&&t.parentAction,metadata:r}};return new Promise((function(e){var t=function(){for(var e=0;e<25&&n.iterationCounter<o;e++){var t=n.select(r),i=n.expand(t),a=n.playout(i);n.backpropagate(i,a),n.iterationCounter++}n.iterationCallback({iterationCounter:n.iterationCounter,numIterations:o,metadata:r})};if(n.iterationCounter=0,n.getOpt("async")){!function r(){n.iterationCounter<o?(t(),setTimeout(r,0)):e(i())}()}else{for(;n.iterationCounter<o;)t();e(i())}}))}}]),i}(so),uo=function(e){s(r,e);var t=d(r);function r(){return n(this,r),t.apply(this,arguments)}return o(r,[{key:"play",value:function(e,t){var n=e.G,r=e.ctx,o=this.enumerate(n,r,t);return Promise.resolve({action:this.random(o)})}}]),r}(so);async function fo(e,t){var n=e.store.getState(),r=n.ctx.currentPlayer;n.ctx.activePlayers&&(r=Object.keys(n.ctx.activePlayers)[0]);var o=await t.play(n,r),i=o.action,a=o.metadata;return i&&(i.payload.metadata=a,e.store.dispatch(i)),i}function po(e,t,n){const r=e.slice();return r[7]=t[n],r}function vo(e){let t,n,r;return{c(){t=vt("p"),t.textContent="No bots available.",n=gt(),r=vt("p"),r.innerHTML='\n        Follow the instructions\n        <a href="https://boardgame.io/documentation/#/tutorial?id=bots" target="_blank">\n          here</a>\n        to set up bots.\n      '},m(e,o){ft(e,t,o),ft(e,n,o),ft(e,r,o)},p:Je,i:Je,o:Je,d(e){e&&dt(t),e&&dt(n),e&&dt(r)}}}function ho(e){let t;return{c(){t=vt("p"),t.textContent="The bot debugger is only available in singleplayer mode."},m(e,n){ft(e,t,n)},p:Je,i:Je,o:Je,d(e){e&&dt(t)}}}function mo(e){let t,n,r,o,i,a,l,s,c,u,f,d,p,v,h,m,g,y,b=Object.keys(e[7].opts()).length;const x=new Pn({props:{value:"1",onPress:e[13],label:"reset"}}),w=new Pn({props:{value:"2",onPress:e[11],label:"play"}}),$=new Pn({props:{value:"3",onPress:e[12],label:"simulate"}});let P=Object.keys(e[8]),O=[];for(let t=0;t<P.length;t+=1)O[t]=go(po(e,P,t));let k=b&&yo(e),I=(e[5]||e[3])&&bo(e);return{c(){t=vt("section"),n=vt("h3"),n.textContent="Controls",r=gt(),o=vt("li"),on(x.$$.fragment),i=gt(),a=vt("li"),on(w.$$.fragment),l=gt(),s=vt("li"),on($.$$.fragment),c=gt(),u=vt("section"),f=vt("h3"),f.textContent="Bot",d=gt(),p=vt("select");for(let e=0;e<O.length;e+=1)O[e].c();v=gt(),k&&k.c(),h=gt(),I&&I.c(),m=yt(),xt(n,"class","svelte-hsd9fq"),xt(o,"class","svelte-hsd9fq"),xt(a,"class","svelte-hsd9fq"),xt(s,"class","svelte-hsd9fq"),xt(f,"class","svelte-hsd9fq"),void 0===e[4]&&Ft(()=>e[19].call(p))},m(b,P,E){ft(b,t,P),ut(t,n),ut(t,r),ut(t,o),an(x,o,null),ut(t,i),ut(t,a),an(w,a,null),ut(t,l),ut(t,s),an($,s,null),ft(b,c,P),ft(b,u,P),ut(u,f),ut(u,d),ut(u,p);for(let e=0;e<O.length;e+=1)O[e].m(p,null);Pt(p,e[4]),ft(b,v,P),k&&k.m(b,P),ft(b,h,P),I&&I.m(b,P),ft(b,m,P),g=!0,E&&Xe(y),y=[bt(p,"change",e[19]),bt(p,"change",e[10])]},p(e,t){if(256&t){let n;for(P=Object.keys(e[8]),n=0;n<P.length;n+=1){const r=po(e,P,n);O[n]?O[n].p(r,t):(O[n]=go(r),O[n].c(),O[n].m(p,null))}for(;n<O.length;n+=1)O[n].d(1);O.length=P.length}16&t&&Pt(p,e[4]),128&t&&(b=Object.keys(e[7].opts()).length),b?k?(k.p(e,t),128&t&&en(k,1)):(k=yo(e),k.c(),en(k,1),k.m(h.parentNode,h)):k&&(Xt(),tn(k,1,1,()=>{k=null}),Zt()),e[5]||e[3]?I?I.p(e,t):(I=bo(e),I.c(),I.m(m.parentNode,m)):I&&(I.d(1),I=null)},i(e){g||(en(x.$$.fragment,e),en(w.$$.fragment,e),en($.$$.fragment,e),en(k),g=!0)},o(e){tn(x.$$.fragment,e),tn(w.$$.fragment,e),tn($.$$.fragment,e),tn(k),g=!1},d(e){e&&dt(t),ln(x),ln(w),ln($),e&&dt(c),e&&dt(u),pt(O,e),e&&dt(v),k&&k.d(e),e&&dt(h),I&&I.d(e),e&&dt(m),Xe(y)}}}function go(e){let t,n,r,o=e[7]+"";return{c(){t=vt("option"),n=mt(o),t.__value=r=e[7],t.value=t.__value},m(e,r){ft(e,t,r),ut(t,n)},p:Je,d(e){e&&dt(t)}}}function yo(e){let t,n,r,o,i,a,l,s,c;const u=new ao({props:{bot:e[7]}});return{c(){t=vt("section"),n=vt("h3"),n.textContent="Options",r=gt(),o=vt("label"),o.textContent="debug",i=gt(),a=vt("input"),l=gt(),on(u.$$.fragment),xt(n,"class","svelte-hsd9fq"),xt(o,"class","svelte-hsd9fq"),xt(a,"type","checkbox"),xt(a,"class","svelte-hsd9fq")},m(f,d,p){ft(f,t,d),ut(t,n),ut(t,r),ut(t,o),ut(t,i),ut(t,a),a.checked=e[1],ut(t,l),an(u,t,null),s=!0,p&&Xe(c),c=[bt(a,"change",e[20]),bt(a,"change",e[9])]},p(e,t){2&t&&(a.checked=e[1]);const n={};128&t&&(n.bot=e[7]),u.$set(n)},i(e){s||(en(u.$$.fragment,e),s=!0)},o(e){tn(u.$$.fragment,e),s=!1},d(e){e&&dt(t),ln(u),Xe(c)}}}function bo(e){let t,n,r,o,i=e[2]&&e[2]<1&&xo(e),a=e[5]&&wo(e);return{c(){t=vt("section"),n=vt("h3"),n.textContent="Result",r=gt(),i&&i.c(),o=gt(),a&&a.c(),xt(n,"class","svelte-hsd9fq")},m(e,l){ft(e,t,l),ut(t,n),ut(t,r),i&&i.m(t,null),ut(t,o),a&&a.m(t,null)},p(e,n){e[2]&&e[2]<1?i?i.p(e,n):(i=xo(e),i.c(),i.m(t,o)):i&&(i.d(1),i=null),e[5]?a?a.p(e,n):(a=wo(e),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(e){e&&dt(t),i&&i.d(),a&&a.d()}}}function xo(e){let t;return{c(){t=vt("progress"),t.value=e[2]},m(e,n){ft(e,t,n)},p(e,n){4&n&&(t.value=e[2])},d(e){e&&dt(t)}}}function wo(e){let t,n,r,o,i,a,l,s=JSON.stringify(e[6])+"";return{c(){t=vt("li"),n=mt("Action: "),r=mt(e[5]),o=gt(),i=vt("li"),a=mt("Args: "),l=mt(s),xt(t,"class","svelte-hsd9fq"),xt(i,"class","svelte-hsd9fq")},m(e,s){ft(e,t,s),ut(t,n),ut(t,r),ft(e,o,s),ft(e,i,s),ut(i,a),ut(i,l)},p(e,t){32&t&&wt(r,e[5]),64&t&&s!==(s=JSON.stringify(e[6])+"")&&wt(l,s)},d(e){e&&dt(t),e&&dt(o),e&&dt(i)}}}function $o(e){let t,n,r,o,i;const a=[mo,ho,vo],l=[];function s(e,t){return e[0].game.ai&&!e[0].multiplayer?0:e[0].multiplayer?1:2}return n=s(e),r=l[n]=a[n](e),{c(){t=vt("section"),r.c()},m(r,a,s){ft(r,t,a),l[n].m(t,null),o=!0,s&&i(),i=bt(window,"keydown",e[14])},p(e,[o]){let i=n;n=s(e),n===i?l[n].p(e,o):(Xt(),tn(l[i],1,1,()=>{l[i]=null}),Zt(),r=l[n],r||(r=l[n]=a[n](e),r.c()),en(r,1),r.m(t,null))},i(e){o||(en(r),o=!0)},o(e){tn(r),o=!1},d(e){e&&dt(t),l[n].d(),i()}}}function Po(e,t,n){let{client:r}=t;const{secondaryPane:o}=Nt("secondaryPane"),i={MCTS:co,Random:uo};let a=!1,l=null,s=0,c=null;const u=({iterationCounter:e,numIterations:t,metadata:r})=>{n(3,s=e),n(2,l=e/t),c=r,a&&c&&o.set({component:Rr,metadata:c})};let f,d,p,v;function h(){r.overrideGameState(null),o.set(null),n(1,a=!1)}return r.game.ai&&(f=new co({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:u}),f.setOpt("async",!0)),Ct(h),e.$set=e=>{"client"in e&&n(0,r=e.client)},[r,a,l,s,d,p,v,f,i,function(){a&&c?o.set({component:Rr,metadata:c}):o.set(null)},function(){n(7,f=new(0,i[d])({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:u})),f.setOpt("async",!0),n(5,p=null),c=null,o.set(null),n(3,s=0)},async function(){n(5,p=null),c=null,n(3,s=0);const e=await fo(r,f);e&&(n(5,p=e.payload.type),n(6,v=e.payload.args))},function(e=1e4,t=100){return n(5,p=null),c=null,n(3,s=0),(async()=>{for(let n=0;n<e;n++){if(!await fo(r,f))break;await new Promise(e=>setTimeout(e,t))}})()},function(){r.reset(),n(5,p=null),c=null,n(3,s=0),h()},function(e){27==e.keyCode&&h()},c,o,u,h,function(){d=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(4,d),n(8,i)},function(){a=this.checked,n(1,a)}]}class Oo extends un{constructor(e){var t;super(),document.getElementById("svelte-hsd9fq-style")||((t=vt("style")).id="svelte-hsd9fq-style",t.textContent="li.svelte-hsd9fq{list-style:none;margin:none;margin-bottom:5px}h3.svelte-hsd9fq{text-transform:uppercase}label.svelte-hsd9fq{font-weight:bold;color:#999}input[type='checkbox'].svelte-hsd9fq{vertical-align:middle}",ut(document.head,t)),cn(this,e,Po,$o,et,{client:0})}}function ko(e){let t,n,r,o,i,a;const l=new bn({props:{panes:e[4],pane:e[1]}});l.$on("change",e[6]);var s=e[4][e[1]].component;function c(e){return{props:{client:e[0]}}}if(s)var u=new s(c(e));let f=e[3]&&Io(e);return{c(){t=vt("div"),on(l.$$.fragment),n=gt(),r=vt("div"),u&&on(u.$$.fragment),o=gt(),f&&f.c(),xt(r,"class","pane svelte-1h5kecx"),xt(t,"class","debug-panel svelte-1h5kecx")},m(e,i){ft(e,t,i),an(l,t,null),ut(t,n),ut(t,r),u&&an(u,r,null),ut(t,o),f&&f.m(t,null),a=!0},p(e,n){const o={};2&n&&(o.pane=e[1]),l.$set(o);const i={};if(1&n&&(i.client=e[0]),s!==(s=e[4][e[1]].component)){if(u){Xt();const e=u;tn(e.$$.fragment,1,0,()=>{ln(e,1)}),Zt()}s?(on((u=new s(c(e))).$$.fragment),en(u.$$.fragment,1),an(u,r,null)):u=null}else s&&u.$set(i);e[3]?f?(f.p(e,n),8&n&&en(f,1)):(f=Io(e),f.c(),en(f,1),f.m(t,null)):f&&(Xt(),tn(f,1,1,()=>{f=null}),Zt())},i(e){a||(en(l.$$.fragment,e),u&&en(u.$$.fragment,e),en(f),Ft(()=>{i||(i=rn(t,vn,{x:400},!0)),i.run(1)}),a=!0)},o(e){tn(l.$$.fragment,e),u&&tn(u.$$.fragment,e),tn(f),i||(i=rn(t,vn,{x:400},!1)),i.run(0),a=!1},d(e){e&&dt(t),ln(l),u&&ln(u),f&&f.d(),e&&i&&i.end()}}}function Io(e){let t,n;var r=e[3].component;function o(e){return{props:{metadata:e[3].metadata}}}if(r)var i=new r(o(e));return{c(){t=vt("div"),i&&on(i.$$.fragment),xt(t,"class","secondary-pane svelte-1h5kecx")},m(e,r){ft(e,t,r),i&&an(i,t,null),n=!0},p(e,n){const a={};if(8&n&&(a.metadata=e[3].metadata),r!==(r=e[3].component)){if(i){Xt();const e=i;tn(e.$$.fragment,1,0,()=>{ln(e,1)}),Zt()}r?(on((i=new r(o(e))).$$.fragment),en(i.$$.fragment,1),an(i,t,null)):i=null}else r&&i.$set(a)},i(e){n||(i&&en(i.$$.fragment,e),n=!0)},o(e){i&&tn(i.$$.fragment,e),n=!1},d(e){e&&dt(t),i&&ln(i)}}}function Eo(e){let t,n,r,o=e[2]&&ko(e);return{c(){o&&o.c(),t=yt()},m(i,a,l){o&&o.m(i,a),ft(i,t,a),n=!0,l&&r(),r=bt(window,"keypress",e[7])},p(e,[n]){e[2]?o?(o.p(e,n),4&n&&en(o,1)):(o=ko(e),o.c(),en(o,1),o.m(t.parentNode,t)):o&&(Xt(),tn(o,1,1,()=>{o=null}),Zt())},i(e){n||(en(o),n=!0)},o(e){tn(o),n=!1},d(e){o&&o.d(e),e&&dt(t),r()}}}function _o(e,t,n){let r,{client:o}=t;const i={main:{label:"Main",shortcut:"m",component:Qn},log:{label:"Log",shortcut:"l",component:Zr},info:{label:"Info",shortcut:"i",component:or},ai:{label:"AI",shortcut:"a",component:Oo}},a=dn(!1),l=dn(null);nt(e,l,e=>n(3,r=e)),Mt("hotkeys",{disableHotkeys:a}),Mt("secondaryPane",{secondaryPane:l});let s="main";let c=!0;return e.$set=e=>{"client"in e&&n(0,o=e.client)},[o,s,c,r,i,l,function(e){n(1,s=e.detail)},function(e){"."!=e.key?c&&Object.entries(i).forEach(([t,{shortcut:r}])=>{e.key==r&&n(1,s=t)}):n(2,c=!c)}]}class Do extends un{constructor(e){var t;super(),document.getElementById("svelte-1h5kecx-style")||((t=vt("style")).id="svelte-1h5kecx-style",t.textContent=".debug-panel.svelte-1h5kecx{position:fixed;color:#555;font-family:monospace;display:flex;flex-direction:row;text-align:left;right:0;top:0;height:100%;font-size:14px;box-sizing:border-box;opacity:0.9}.pane.svelte-1h5kecx{flex-grow:2;overflow-x:hidden;overflow-y:scroll;background:#fefefe;padding:20px;border-left:1px solid #ccc;box-shadow:-1px 0 5px rgba(0, 0, 0, 0.2);box-sizing:border-box;width:280px}.secondary-pane.svelte-1h5kecx{background:#fefefe;overflow-y:scroll}.debug-panel.svelte-1h5kecx button, select{cursor:pointer;outline:none;background:#eee;border:1px solid #bbb;color:#555;padding:3px;border-radius:3px}.debug-panel.svelte-1h5kecx button{padding-left:10px;padding-right:10px}.debug-panel.svelte-1h5kecx button:hover{background:#ddd}.debug-panel.svelte-1h5kecx button:active{background:#888;color:#fff}.debug-panel.svelte-1h5kecx section{margin-bottom:20px}",ut(document.head,t)),cn(this,e,_o,Eo,et,{client:0})}}function jo({game:e,numPlayers:t,setupData:n}){t||(t=2);let r={G:{},ctx:(e=Ke(e)).flow.ctx(t),plugins:{}};r=((e,t)=>([...Se,...t.game.plugins].filter(e=>void 0!==e.setup).forEach(n=>{const r=n.name,o=n.setup({G:e.G,ctx:e.ctx,game:t.game});e={...e,plugins:{...e.plugins,[r]:{data:o}}}}),e))(r,{game:e}),r=ze(r,{game:e,playerID:void 0});const o=Ae(r);r.G=e.setup(o,n);let i={...r,_undo:[],_redo:[],_stateID:0};return i=e.flow.init(i),i=Me(i,{game:e}),i}function So(e,t,n,r,o,i){return t.reduce((function(t,a){return t[a]=function(){var t=r;if(!i&&null==r){var l=n.getState();t=l.ctx.currentPlayer}for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];n.dispatch(q[e](a,c,t,o))},t}),{})}var Ao=So.bind(null,"makeMove"),Co=So.bind(null,"gameEvent"),zo=So.bind(null,"plugin"),Mo=function(){function e(t){var r=this,o=t.game,i=t.debug,a=t.numPlayers,l=t.multiplayer,s=t.gameID,c=t.playerID,u=t.credentials,f=t.enhancer;n(this,e),this.game=Ke(o),this.playerID=c,this.gameID=s,this.credentials=u,this.multiplayer=l,this.debug=i,this.gameStateOverride=null,this.subscribers={},this._running=!1,this.reducer=lo({game:this.game,isClient:void 0!==l,numPlayers:a}),this.initialState=null,l||(this.initialState=jo({game:this.game,numPlayers:a})),this.reset=function(){r.store.dispatch(S(r.initialState))},this.undo=function(){r.store.dispatch(A(c,u))},this.redo=function(){r.store.dispatch(C(c,u))},this.store=null,this.log=[];var d=function(e){return function(t){return function(n){var o=t(n),i=e.getState();switch(n.type){case"MAKE_MOVE":case"GAME_EVENT":var a=i.deltalog;r.log=[].concat(p(r.log),p(a));break;case"RESET":r.log=[];break;case"UPDATE":var l=-1;r.log.length>0&&(l=r.log[r.log.length-1]._stateID);var s=n.deltalog||[];s=s.filter((function(e){return e._stateID>l})),r.log=[].concat(p(r.log),p(s));break;case"SYNC":r.initialState=n.initialState,r.log=n.log||[]}return o}}},v=function(e){return function(t){return function(n){var o=e.getState(),i=t(n);return 1!=n.clientOnly&&r.transport.onAction(o,n),i}}},h=function(){return function(e){return function(t){var n=e(t);return r.notifySubscribers(),n}}};f=void 0!==f?k(I(h,v,d),f):I(h,v,d),this.store=w(this.reducer,this.initialState,f),this.transport={isConnected:!0,onAction:function(){},subscribe:function(){},subscribeGameMetadata:function(e){},connect:function(){},disconnect:function(){},updateGameID:function(){},updatePlayerID:function(){}},l&&(this.transport=l({gameKey:o,game:this.game,store:this.store,gameID:s,playerID:c,gameName:this.game.name,numPlayers:a})),this.createDispatchers(),this.transport.subscribeGameMetadata((function(e){r.gameMetadata=e})),this._debugPanel=null}return o(e,[{key:"notifySubscribers",value:function(){var e=this;Object.values(this.subscribers).forEach((function(t){return t(e.getState())}))}},{key:"overrideGameState",value:function(e){this.gameStateOverride=e,this.notifySubscribers()}},{key:"start",value:function(){this.transport.connect(),this._running=!0;var e=null;if(e=Do,this.debug&&this.debug.impl&&(e=this.debug.impl),null!==e&&!1!==this.debug&&null==this._debugPanel&&"undefined"!=typeof document){var t=document.body;this.debug&&void 0!==this.debug.target&&(t=this.debug.target),t&&(this._debugPanel=new e({target:t,props:{client:this}}))}}},{key:"stop",value:function(){this.transport.disconnect(),this._running=!1,null!=this._debugPanel&&(this._debugPanel.$destroy(),this._debugPanel=null)}},{key:"subscribe",value:function(e){var t=this,n=Object.keys(this.subscribers).length;return this.subscribers[n]=e,this.transport.subscribe((function(){return t.notifySubscribers()})),!this._running&&this.multiplayer||e(this.getState()),function(){delete t.subscribers[n]}}},{key:"getInitialState",value:function(){return this.initialState}},{key:"getConnectionStatus",value:function(){return{latency:this.transport.latency,status:this.transport.status}}},{key:"getState",value:function(){var e=this.store.getState();if(null!==this.gameStateOverride&&(e=this.gameStateOverride),null===e)return e;var t=!0,n=this.game.flow.isPlayerActive(e.G,e.ctx,this.playerID);this.multiplayer&&!n&&(t=!1),this.multiplayer||null===this.playerID||void 0===this.playerID||n||(t=!1),void 0!==e.ctx.gameover&&(t=!1);var r=this.game.playerView(e.G,e.ctx,this.playerID),o=l(l({},e),{},{isActive:t,G:r,log:this.log}),i=this.transport.isConnected,a=this.getConnectionStatus();return o=l(l({},o),{},{isConnected:i,connection:a})}},{key:"createDispatchers",value:function(){this.moves=Ao(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=Co(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer),this.plugins=zo(this.game.pluginNames,this.store,this.playerID,this.credentials,this.multiplayer)}},{key:"updatePlayerID",value:function(e){this.playerID=e,this.createDispatchers(),this.transport.updatePlayerID(e),this.notifySubscribers()}},{key:"updateGameID",value:function(e){this.gameID=e,this.createDispatchers(),this.transport.updateGameID(e),this.notifySubscribers()}},{key:"updateCredentials",value:function(e){this.credentials=e,this.createDispatchers(),this.notifySubscribers()}}]),e}();e.Client=function(e){return new Mo(e)},Object.defineProperty(e,"__esModule",{value:!0})}));
